'++LotusScript Development Environment:2:5:(Options):0:74
'******************************************************************************************************************	
'* 
'*		  							CLASS <CARATULA>
'* 
'******************************************************************************************************************	
%REM 
Esta clase representa un objeto CARATULA de un expediente

CONSTRUCTOR
Sub new(byval sNroExpediente As String, byval bCrear as Integer)
		'Si bCrear = True, devuelve el doc carátula con universalid sNroExpediente
		'Si bCrear = False, devuelve el doc caratula con numero de expediente sNroExpediente
Parámetros:
	sNroExpediente	(IN) = número de expediente o universalid del documento carátula
	bCrear		(IN) = indica si se está creando el expediente (true) o no (false)

PROPIEDADES
Get/Set NroExp() As String
		'Devuelve/Setea el número de expediente correspondiente a esta carátula
Get/Set Tema() As String
		'Devuelve/Setea el nombre del tema del expediente
Get/Set Asunto() As String
		'Devuelve/Setea el asunto del expediente
Get/Set OficinaActual As String
		'Devuelve/Setea el nombre de la unidad en la que se encuentra el expediente
Get/Set OficinaAnterior As String
		'Devuelve/Setea el nombre de la unidad que actuó sobre el expediente en el paso anterior al actual
Get/Set OficinaInicial() As String
		'Devuelve/Setea el nombre de la unidad que inició el expediente
Get/Set CantActuaciones() As Integer
		'Devuelve/Setea la cantidad de actuaciones del expediente
Get/Set Estado() As String
		'Devuelve/Setea el estado del expediente
Get/Set FechaCreacion() As String
		'Devuelve/Setea la fecha de creación del expediente
Get/Set Autores() As Vector
		'Devuelve/Setea los autores de la carátula
Get/Set Lectores() As Vector
		'Devuelve/Setea un vector con los lectores de la carátula
Get/Set Seguridad() As String
		'Devuelve/Setea el tipo de seguridad del expediente (normal o confidencial)
Get/Set FechaPase As Variant
		'Devuelve/Setea la última fecha de pase del expediente
		

MÉTODOS
Function save()
		'Salva el documento carátula

Function getRecorridoColumna(byval nColumna As Integer) As Vector
		'Devuelve los valores de la columna indicada para la tabla de recorrido
Parámetros:
	nColumna	(IN) = número de columna cuyos valores se quieren obtener

Function setRecorridoColumna(byval nColumna As Integer,vColumna As Vector)
		'Setea los valores de la columna indicada para la tabla de recorrido con los de vColumna
Parámetros:
	nColumna	(IN) = número de columna cuyos valores se quieren setear
	vColumna	(IN) = vector con los valores para la columna

Sub addRecorrido(Byval fechaRecibido As Variant)
		'Agrega una línea a la tabla de recorrido
Parámetros:
	fechaRecibido	(IN) = fecha de recepción del expediente en la actuación actual

Sub addLog(vLog As Vector)
		'Agrega una línea al log
Parámetros:
	vLog	(IN) = vector con los datos de la línea a agregar al log. Debe tener
			  el formato {Operacion, usuario, fecha-hora}



%END REM

Option Declare
Use "FuncionesGenerales"
Use "UnidadExp Class"
Use "Errores Generales"
Use "ConstantesDBGestionDoc"
Use "ConstantesDBWebServices"

'++LotusScript Development Environment:2:5:(Forward):0:1
Declare Public Class Caratula

'++LotusScript Development Environment:2:5:(Declarations):0:10
'CONSTANTES PÚBLICAS
Public Const NRO_EX_VACIO					= "VACIO"

'ERRORES GENERADOS


'CONSTANTES PRIVADAS
Const	CAMPO_FCARATULA_NRO_EXPEDIENTE				="ccNroExp"
Const	CAMPO_FCARATULA_NRO_RESERVADO_EXPEDIENTE	="ccNroExpReservado"
Const	CAMPO_FCARATULA_ANIO_RESERVADO				="ccAnioReservado"
Const	CAMPO_FCARATULA_NRO_COPIA_EXPEDIENTE		="NroCopia"
Const	CAMPO_FCARATULA_TEMA						="sTema"
Const 	CAMPO_FCARATULA_VERSION_TEMA				="nVersionRuta"
Const	CAMPO_FCARATULA_ASUNTO						="sAsunto"
Const	CAMPO_FCARATULA_OFICINA_ACTUAL				="ccOficinaActual"
Const	CAMPO_FCARATULA_OFICINA_ANTERIOR			="ccOficinaAnterior" 
Const	CAMPO_FCARATULA_OFICINA_INCIAL				="ccOficinaInicial"
Const	CAMPO_FCARATULA_CANT_ACTUACIONES			="cCantAct"
Const	CAMPO_FCARATULA_ESTADO						="ccEstado"

Const	CAMPO_FCARATULA_FECHA_CREACION				="ccfCreacion"
Const	CAMPO_FCARATULA_FECHA_ARCHIVADO				="fFechaArchivado"
Const	CAMPO_FCARATULA_AUTORES						="sAutores"
Const	CAMPO_FCARATULA_LECTORES					="sLectores"
Const	CAMPO_FCARATULA_AUTORES_PERMANENTES			="sAutoresPer"

Const CAMPO_NRO_EXPEDIENTE_SEM						="sNroExpedientesSEM"
Const CAMPO_URL_SEM									="sUrlSEM"

Const	CAMPO_FCARATULA_RECORRIDO_ENTRADA		="sRecorridoFechaEntrada"
Const	CAMPO_FCARATULA_RECORRIDO_SALIDA		="sRecorridoFechaSalida"
Const	CAMPO_FCARATULA_RECORRIDO_UNIDAD		="sRecorridoUnidad"
Const	CAMPO_FCARATULA_LOG_OPERACION			="sLogOperacion"
Const	CAMPO_FCARATULA_LOG_USUARIO				="sLogusuario"
Const	CAMPO_FCARATULA_LOG_FECHAHORA			="sLogFechaHora"
Const	CAMPO_FCARATULA_SEGURIDAD				="ccSeguridad"
Const	CAMPO_FCARATULA_FECHA_PASE				="ccFechaPase"
Public Const CAMPO_FCARATULA_PAQUETE			="rTienePaquete"

Const	CAMPO_FCARATULA_AGREGADOS_NRO			="sListaAgregadosNro"
Const	CAMPO_FCARATULA_AGREGADOS_UNIDAD		="sListaAgregadosUnidad"
Const	CAMPO_FCARATULA_AGREGADOS_ACTUACION		="sListaAgregadosAct"
Const	CAMPO_FCARATULA_AGREGADOS_FECHA			="sListaAgregadosFecha"
Const	CAMPO_FCARATULA_PADRE_DE_AGREGADO		="sCodigoPadre"


Const	CAMPO_FCARATULA_PAQ_RECIBIDO			="fPaqRecibido"
Const	CAMPO_FCARATULA_PAQ_LUGAR				="sPaqLugar"
Const	CAMPO_FCARATULA_PAQ_RESPONSABLE			="sPaqResponsable"

Const	CAMPO_FCARATULA_HPAQ_FECHAS				="fHPaqFechas"
Const	CAMPO_FCARATULA_HPAQ_LUGARES			="sHPaqLugares"
Const	CAMPO_FCARATULA_HPAQ_RESPONSABLES		="sHPaqResponsables"

Const	CAMPO_FCARATULA_FIRMANTES				="sFirmantes"
Const	CAMPO_FCARATULA_RESERVADO_POR			="sReservadoPor"

Const	CAMPO_FCARATULA_NOTIF_SIN_ACUSE			="sNotificados"
Const	CAMPO_FCARATULA_NOTIF_ACUSARON			="sNotifAcusaron"
Const	CAMPO_FCARATULA_TNOTIF_FECHA			="sTNotifFecha"
Const	CAMPO_FCARATULA_TNOTIF_UNIDAD			="sTNotifUnidad"
Const	CAMPO_FCARATULA_TNOTIF_NRO_ACT			="sTNotifNroAct"
Const	CAMPO_FCARATULA_TNOTIF_ACUSE			="sTNotifAcuse"
Const	CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA		="sTNotifAcuseFecha"
Const	CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA_IND	="sTNotifAcuseFechaInd"
Const	CAMPO_FCARATULA_URGENTE					="sUrgenteActs"
Const	CAMPO_FCARATULA_USUARIOS_COPIA			="sUsuariosCopia"
Const 	CAMPO_FCARATULA_FECHA_RECIBIDO			="sFechaRecibido"
Const 	CAMPO_FCARATULA_LOG_FECHA				= "logFecha"
Const 	CAMPO_FCARATULA_LOG_USUARIO_EJ			= "logUsuarioEj"
Const 	CAMPO_FCARATULA_LOG_USUARIO_COPIA		= "logUsuarioCopia"
Const 	CAMPO_FCARATULA_TEXTO_COPIA				= "textoCopia"
Const 	CAMPO_FCARATULA_ARBOL					= "sArbolAgregacion"
Const 	CAMPO_FCARATULA_ACTS_GEN_ASUNTOS		= "ActsGeneraronAsuntos"
Const 	CAMPO_FCARATULA_NRO_SESION_PTOS			= "sNrosSesionPtos"
Const 	CAMPO_FCARATULA_NRO_PTOS_EN_SESION		= "sNrosPtosEnSesion"
Const 	CAMPO_FCARATULA_ESTADO_PTOS_EN_SESION 	= "sEstadoPtosEnSesion"
Const 	CAMPO_FCARATULA_NRO_SESION_RESOL		= "sNrosSesionResol"
Const 	CAMPO_FCARATULA_NRO_RESOL				= "sNrosResol"
Const 	CAMPO_FCARATULA_FECHA_RESOL 			= "sFechasResol"
Const 	CAMPO_FCARATULA_PDF_RESOL 				= "sPdfsResol"
Const 	CAMPO_FCARATULA_VECTOR_CAMPOS			= "VectorCampos"
Const 	CAMPO_FCARATULA_USUARIOCONF				= "sUsuarioMarcaConf"


'Historial de copia de expediente (las acciones de copiar y quitar copia)
Const 	CAMPO_FCARATULA_H_US_COPIA	= "hUsCopia"
Const 	CAMPO_FCARATULA_H_OF_COPIA	= "hOfCopia"
Const 	CAMPO_FCARATULA_H_FECHA		= "hFecha"
Const 	CAMPO_FCARATULA_H_ACCION	= "hAccion"
Const 	CAMPO_FCARATULA_H_CANT_ACT	= "hCantAct"
Const 	CAMPO_FCARATULA_H_NRO_COPIA	= "hNroCopia"

'Campo donde se guarda para cada copia, la cantidad de actuaciones del expediente que se copiaron en cada una de las "copias de expediente"
Const 	CAMPO_FCARATULA_CANT_ACT_COP		= "cantidadActCopiadas"

'Agregaciones, Desagregaciones
Const		CAMPO_FCARATULA_AGR_FECHA			="sLogAgrFecha"
Const		CAMPO_FCARATULA_AGR_USUARIO			="sLogAgrUsuario"
Const		CAMPO_FCARATULA_AGR_OFICINA			="sLogAgrOficina"
Public Const	CAMPO_FCARATULA_AGR_NROEXP			="sLogAgrNroExp"
Const		CAMPO_FCARATULA_AGR_OPERACION			="sLogAgrOperacion"
Public Const	CAMPO_FCARATULA_AGR_ACTUACION		="sLogAgrNroAct"

'Campos de anexos en las caratulas
Public Const	CAMPO_FCARATULA_ANEXOS_NOMBRES		="sAnexoNombre"
Public Const	CAMPO_FCARATULA_ANEXOS_TAMAÑO		="sAnexoTamanio"
Public Const	CAMPO_FCARATULA_ANEXOS_ACTUACION	="sAnexoActuacion"

Public Const 	ERROR_ANEXO_NOT_FOUND 			= 31021
Public Const   MSG_ERROR_ANEXO_NOT_FOUND		= "No se encontró el anexo: "

'Campos para expedientes migrados
Public Const CAMPO_FCARATULA_FERMIGRADO				="FechaEntradaRecorridoMigrado"
Public Const CAMPO_FCARATULA_FSRMIGRADO				="FechaSalidaRecorridoMigrado"
Public Const CAMPO_FCARATULA_URMIGRADO				="UnidadRecorridoMigrado"
Public Const CAMPO_FCARATULA_DRMIGRADO				="DescMovimientoMigrado"
Public Const CAMPO_FCARATULA_NROBOLMIGRADO			="NroBoleta"
Public Const CAMPO_FCARATULA_MIGRADO				="Migrado"
Public Const CAMPO_FCARATULA_PAQUETE_EN_AGREGADO	="PaqueteEnAgregado"

'Campos para el modulo de avisos
Public Const CAMPO_AVISAR_SOLICITANTE				="rAvisarSolicitante"
Public Const CAMPO_CORREOS_AVISOS					="ccCorreosAvisos"
Public Const CAMPO_CELULARES_AVISOS					="ccCelularesAvisos"
Public Const CAMPO_TELEFONOS_AVISOS					="ccTelefonosAvisos"
Public Const CAMPO_UNIDADES_AVISOS					="sUnidadesAvisos"
Public Const CAMPO_TIEMPO_AVISOS					="rTiempoAvisos"
Public Const CAMPO_FCARATULA_QUIEN_ENVIA_AVISO_M	="sQuienEnviaAvisoManual"
Public Const CAMPO_FCARATULA_CUANDO_ENVIA_AVISO_M	="sCuandoEnviaAvisoManual"
Public Const CAMPO_FCARATULA_A_QUIEN_ENVIA_AVISO_M	="sAQuienEnviaAvisoManual"

'Bandejas
Public Const CAMPO_BANDEJA_1 		= "campoBandeja1"
Public Const CAMPO_BANDEJA_2 		= "campoBandeja2"
Public Const CAMPO_BANDEJA_3 		= "campoBandeja3"
Public Const CAMPO_BANDEJA_4 		= "campoBandeja4"

Public Const CAMPO_BANDEJA_NOMBRE_1 = "nombreBandeja1"
Public Const CAMPO_BANDEJA_NOMBRE_2 = "nombreBandeja2"
Public Const CAMPO_BANDEJA_NOMBRE_3 = "nombreBandeja3"
Public Const CAMPO_BANDEJA_NOMBRE_4 = "nombreBandeja4"

Public Const CAMPO_BANDEJA_TIPO_1 	= "tipoBandeja1"
Public Const CAMPO_BANDEJA_TIPO_2 	= "tipoBandeja2"
Public Const CAMPO_BANDEJA_TIPO_3 	= "tipoBandeja3"
Public Const CAMPO_BANDEJA_TIPO_4 	= "tipoBandeja4"

Public Const CAMPO_BANDEJA_COL_ORD 	= "colOrdBandeja"
Public Const CAMPO_BANDEJA_ORD 		= "ordBandeja"

'Posibles valores de rTiempoAviso
Public Const TIEMPO_TODOS			="Todos"
Public Const TIEMPO_ALGUNAS			="Algunos"
Public Const TIEMPO_MANUAL			="Manual"

'Integracion con formularios
Public Const CAMPO_INTEG_FORM_BLOQ			= "sBloqueante"
Public Const CAMPO_INTEG_FORM_PATH_WF		= "sPathWebForm"
Public Const CAMPO_INTEG_FORM_NRO_FORM		= "sNroForm"
Public Const CAMPO_INTEG_FORM_USER			= "sUsuario"
Public Const CAMPO_INTEG_FORM_SECCION		= "sSeccion"

'Vinculacion entre expedientes
Public Const CAMPO_VINCULACION_EXP			= "sExpedientesVinculados"
Public Const CAMPO_VINCULACION_BASES		= "sBasesExpVinculados"
Public Const CAMPO_VINCULACION_SERVS		= "sServidoresExpVinculados"
Public Const CAMPO_VINCULACION_UIDS			= "sUidsExpVinculados"

'******************************************************************************************************************	
'*
'*									CLASS <CARATULA>
'*
'******************************************************************************************************************	

'******************************************************************************************************************	
Public Class Caratula
	'******************************************************************************************************************		
	
	'MIEMBROS PRIVADOS
	Private db As notesDatabase
	Private doc As notesdocument
	
	'******************************************************************************************************************	
	
	
	'PROPIEDADES
	
	Public Property Set UrgenteActs As Vector
		On Error Goto HANDLER
		
		If UrgenteActs.cantElem > 0 Then
			doc.replaceItemValue CAMPO_FCARATULA_URGENTE,UrgenteActs.values
		Else
			doc.replaceItemValue CAMPO_FCARATULA_URGENTE,""
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set UrgenteActs","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set UsuariosCopia As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_USUARIOS_COPIA,UsuariosCopia.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set UsuariosCopia","")
		Exit Property	
	End Property
	
	
	Public Property get NuevoDatoPrivado As String
		On Error GoTo HANDLER
		
		NuevoDatoPrivado = doc.getitemvalue( "sUIdDocPrivado")(0)
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NuevoDatoPrivado","")
		Exit Property	
	End Property
	
	
	Public Property Set NuevoDatoPrivado As String
		On Error GoTo HANDLER
		
		doc.replaceItemValue "sUIdDocPrivado",NuevoDatoPrivado
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NuevoDatoPrivado","")
		Exit Property	
	End Property
	
	'*****************************************************************************************************************
	
	Public Property Get UsuarioMarcaConfidencial As String
		If doc.Hasitem(CAMPO_FCARATULA_USUARIOCONF) Then
			UsuarioMarcaConfidencial = doc.Getitemvalue(CAMPO_FCARATULA_USUARIOCONF)(0)
		End If		
	End Property
	
	Public Property Set UsuarioMarcaConfidencial As String
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_USUARIOCONF, UsuarioMarcaConfidencial)
	End Property
	'******************************************************************************************************************	
	
	Public Property Get UsuariosCopia As Vector
		On Error Goto HANDLER
		
		Set UsuariosCopia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_USUARIOS_COPIA) Then
			UsuariosCopia.values=doc.GetItemValue(CAMPO_FCARATULA_USUARIOS_COPIA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get UsuariosCopia","")
		Exit Property	
	End Property
	
	'*****************************************************************************************************************
	
	Public Property Set FechaRecibido As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_FECHA_RECIBIDO,FechaRecibido.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set FechaRecibido","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get FechaRecibido As Vector
		On Error Goto HANDLER
		
		Set FechaRecibido = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_FECHA_RECIBIDO) Then
			FechaRecibido.values=doc.GetItemValue(CAMPO_FCARATULA_FECHA_RECIBIDO)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get FechaRecibido","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************		
	
	Public Property Set logUsuarioCopia As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_LOG_USUARIO_COPIA,logUsuarioCopia.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set logUsuarioCopia","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get logUsuarioCopia As Vector
		On Error Goto HANDLER
		
		Set logUsuarioCopia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_LOG_USUARIO_COPIA)Then
			logUsuarioCopia.values = doc.GetItemValue(CAMPO_FCARATULA_LOG_USUARIO_COPIA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get logUsuarioCopia","")
		Exit Property	
	End Property
	
	
	'******************************************************************************************************************		
	
	Public Property Set textoCopia As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_TEXTO_COPIA,textoCopia.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set textoCopia","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get textoCopia As Vector
		On Error Goto HANDLER
		
		Set textoCopia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_TEXTO_COPIA)Then
			textoCopia.values = doc.GetItemValue(CAMPO_FCARATULA_TEXTO_COPIA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get textoCopia","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set hUsCopia As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_H_US_COPIA,hUsCopia.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set hUsCopia","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get hUsCopia As Vector
		On Error Goto HANDLER
		
		Set hUsCopia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_H_US_COPIA)Then
			hUsCopia.values = doc.GetItemValue(CAMPO_FCARATULA_H_US_COPIA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get hUsCopia","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************		
	
	Public Property Set hOfCopia As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_H_OF_COPIA,hOfCopia.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set hOfCopia","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get hOfCopia As Vector
		On Error Goto HANDLER
		
		Set hOfCopia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_H_OF_COPIA)Then
			hOfCopia.values = doc.GetItemValue(CAMPO_FCARATULA_H_OF_COPIA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get hOfCopia","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************		
	
	Public Property Set hFecha As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_H_FECHA,hFecha.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set hFecha","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get hFecha As Vector
		On Error Goto HANDLER
		
		Set hFecha = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_H_FECHA)Then
			hFecha.values = doc.GetItemValue(CAMPO_FCARATULA_H_FECHA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get hFecha","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************		
	
	Public Property Set hAccion As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_H_ACCION,hAccion.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set hAccion","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get hAccion As Vector
		On Error Goto HANDLER
		
		Set hAccion = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_H_ACCION)Then
			hAccion.values = doc.GetItemValue(CAMPO_FCARATULA_H_ACCION)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get hAccion","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************		
	
	Public Property Set hCantAct As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_H_CANT_ACT,hCantAct.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set hCantAct","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get hCantAct As Vector
		On Error Goto HANDLER
		
		Set hCantAct = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_H_CANT_ACT)Then
			hCantAct.values = doc.GetItemValue(CAMPO_FCARATULA_H_CANT_ACT)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get hCantAct","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set hNroCopia As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_H_NRO_COPIA,hNroCopia.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set hNroCopia","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get hNroCopia As Vector
		On Error Goto HANDLER
		
		Set hNroCopia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_H_NRO_COPIA)Then
			hNroCopia.values = doc.GetItemValue(CAMPO_FCARATULA_H_NRO_COPIA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get hNroCopia","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set cantidadActCopiadas  As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_CANT_ACT_COP,cantidadActCopiadas.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set cantidadActCopiadas ","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get cantidadActCopiadas  As Vector
		On Error Goto HANDLER
		
		Set cantidadActCopiadas  = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_CANT_ACT_COP)Then
			cantidadActCopiadas.values = doc.GetItemValue(CAMPO_FCARATULA_CANT_ACT_COP)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get cantidadActCopiadas ","")
		Exit Property	
	End Property		
	
	'******************************************************************************************************************		
	
	Public Property Set logUsuarioEj As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_LOG_USUARIO_EJ,logUsuarioEj.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set logUsuarioEj","")
		Exit Property	
	End Property	
	
	
	'******************************************************************************************************************	
	
	Public Property Get logUsuarioEj As Vector
		On Error Goto HANDLER
				
				Set logUsuarioEj = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_LOG_USUARIO_EJ)Then
					logUsuarioEj.values = doc.GetItemValue(CAMPO_FCARATULA_LOG_USUARIO_EJ)
				End If
				
				Exit Property
HANDLER:
				Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get logUsuarioEj","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set logFecha As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_LOG_FECHA,logFecha.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set logFecha","")
		Exit Property	
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get logFecha As Vector
		On Error Goto HANDLER
		
		Set logFecha = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_LOG_FECHA)Then
			logFecha.values = doc.GetItemValue(CAMPO_FCARATULA_LOG_FECHA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get logFecha","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set ArbolAgregacion As String
		On Error Goto handler
		doc.ReplaceItemValue CAMPO_FCARATULA_ARBOL,ArbolAgregacion
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set ArbolAgregacion","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoBandeja1 As String
		On Error GoTo handler
		CampoBandeja1 = doc.GetItemValue(CAMPO_BANDEJA_1)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoBandeja1","")
		Exit Property
	End Property
	
	'*****************************************************************************************************************
	
	Public Property Set CampoBandeja1 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_1,CampoBandeja1
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoBandeja1","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoBandeja2 As String
		On Error GoTo handler
		CampoBandeja2 = doc.GetItemValue(CAMPO_BANDEJA_2)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoBandeja2","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	Public Property Set CampoBandeja2 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_2,CampoBandeja2
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoBandeja2","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoBandeja3 As String
		On Error GoTo handler
		CampoBandeja3 = doc.GetItemValue(CAMPO_BANDEJA_3)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoBandeja3","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoBandeja3 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_3,CampoBandeja3
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoBandeja3","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoBandeja4 As String
		On Error GoTo handler
		CampoBandeja4 = doc.GetItemValue(CAMPO_BANDEJA_4)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoBandeja4","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoBandeja4 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_4,CampoBandeja4
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoBandeja4","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoNombreBandeja4 As String
		On Error GoTo handler
		CampoNombreBandeja4 = doc.GetItemValue(CAMPO_BANDEJA_NOMBRE_4)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoNombreBandeja4","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoNombreBandeja4 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_NOMBRE_4,CampoNombreBandeja4
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoNombreBandeja4","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoNombreBandeja3 As String
		On Error GoTo handler
		CampoNombreBandeja3 = doc.GetItemValue(CAMPO_BANDEJA_NOMBRE_3)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoNombreBandeja3","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoNombreBandeja3 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_NOMBRE_3,CampoNombreBandeja3
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoNombreBandeja3","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoNombreBandeja2 As String
		On Error GoTo handler
		CampoNombreBandeja2 = doc.GetItemValue(CAMPO_BANDEJA_NOMBRE_2)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoNombreBandeja2","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoNombreBandeja2 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_NOMBRE_2,CampoNombreBandeja2
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoNombreBandeja2","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoNombreBandeja1 As String
		On Error GoTo handler
		CampoNombreBandeja1 = doc.GetItemValue(CAMPO_BANDEJA_NOMBRE_1)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoNombreBandeja1","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoNombreBandeja1 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_NOMBRE_1,CampoNombreBandeja1
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoNombreBandeja1","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get ColOrdBandeja As String
		On Error GoTo handler
		ColOrdBandeja = doc.GetItemValue(CAMPO_BANDEJA_COL_ORD)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get ColOrdBandeja","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set ColOrdBandeja As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_COL_ORD,ColOrdBandeja
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set ColOrdBandeja","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get OrdBandeja As String
		On Error GoTo handler
		OrdBandeja = doc.GetItemValue(CAMPO_BANDEJA_ORD)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get OrdBandeja","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set OrdBandeja As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_ORD,OrdBandeja
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set OrdBandeja","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoTipoBandeja1 As String
		On Error GoTo handler
		CampoTipoBandeja1 = doc.GetItemValue(CAMPO_BANDEJA_TIPO_1)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoTipoBandeja1","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoTipoBandeja1 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_TIPO_1,CampoTipoBandeja1
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoTipoBandeja1","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoTipoBandeja2 As String
		On Error GoTo handler
		CampoTipoBandeja2 = doc.GetItemValue(CAMPO_BANDEJA_TIPO_2)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoTipoBandeja2","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoTipoBandeja2 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_TIPO_2,CampoTipoBandeja2
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoTipoBandeja2","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoTipoBandeja3 As String
		On Error GoTo handler
		CampoTipoBandeja3= doc.GetItemValue(CAMPO_BANDEJA_TIPO_3)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoTipoBandeja3","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoTipoBandeja3 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_TIPO_3,CampoTipoBandeja3
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoTipoBandeja3","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	Public Property Get CampoTipoBandeja4 As String
		On Error GoTo handler
		CampoTipoBandeja4 = doc.GetItemValue(CAMPO_BANDEJA_TIPO_4)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CampoTipoBandeja4","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set CampoTipoBandeja4 As String
		On Error GoTo handler
		doc.ReplaceItemValue CAMPO_BANDEJA_TIPO_4,CampoTipoBandeja4
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CampoTipoBandeja4","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	
	
	Public Property Get UrgenteActs As Vector
		On Error Goto HANDLER
		
		Set UrgenteActs=New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_URGENTE) Then
			UrgenteActs.values=doc.getItemValue(CAMPO_FCARATULA_URGENTE)
		End If	
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get UrgenteActs","")
		Exit Property	
	End Property
	'******************************************************************************************************************	
	
	Public Property Get TipoRuta As String
		
		On Error Goto HANDLER
		
		TipoRuta=doc.getItemValue(DBSGD_CAMPO_FCARATULA_CAMPO_TIPO_RUTA )(0)
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get TipoRuta","")
		Exit Property
		
	End Property	
	'******************************************************************************************************************	
	
	Public Property Set NotificacionesAcuse As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_TNOTIF_ACUSE,NotificacionesAcuse.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NotificacionesAcuse","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get NotificacionesAcuse As Vector
		On Error Goto HANDLER
		
		Set NotificacionesAcuse = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_TNOTIF_ACUSE) Then
			NotificacionesAcuse.values=doc.GetItemValue(CAMPO_FCARATULA_TNOTIF_ACUSE)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesAcuse","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Set NotificacionesNroAct As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_TNOTIF_NRO_ACT,NotificacionesNroAct.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesNroAct","")
		Exit Property	
	End Property
	'******************************************************************************************************************	
	Function tienePaquete() As Boolean
		On Error Goto handler
		If doc.GetItemValue(CAMPO_FCARATULA_PAQUETE)(0)="Si" Then
			tienePaquete=True
		Else
			tienePaquete=False
		End If
		Exit Function
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método tienePaquete","")
		Exit Function
	End Function
	
	'******************************************************************************************************************	
	
	Function vincularExpedientes(expedientes As Variant)
		On Error GoTo handler
		Dim expedientesABuscar As New vector(0)
		Dim expActual As String
		Dim i As Integer
		expedientesAbuscar.values = expedientes
		expActual  = expedientesAbuscar.getElement(1)
		
		' vinculo el expediente actual a cada uno de los expedientes que selecciono el usuario
		For i=2 To expedientesABuscar.cantElem
			Call vincularExpActualAExpSeleccionados(expActual, expedientesABuscar.getelement(i))
		Next
		Exit Function
HANDLER:
		MsgBox "Clase Caratula - Método vincularExp " & Error & " - "  & Erl 
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método vincularExp ","")
		Exit Function
	End Function
	
	'******************************************************************************************************************		

	Function vincularExpActualAExpSeleccionados(nroExpActual As String, nroExpABuscar As String)
		On Error GoTo handler
		Dim conf As  NotesDocument
		Dim config As Configuracion
		Dim nv As NotesView
		Dim ses As New NotesSession
		Dim expediente As NotesDocument	
		Dim bdExpediente As NotesDatabase
		Dim i As Integer
		Dim encontro As Integer
		Dim cadena As String 
		
		Dim claves As New Vector(0)
		Dim servsClave As New Vector(0)
		Dim pathsClave As New Vector(0)
	
		Set conf = db.Getprofiledocument("fConfiguracion")
		claves.Values = conf.Getitemvalue("sClave")
		servsClave.values = conf.Getitemvalue("sHost")
		pathsClave.values = conf.Getitemvalue("sRuta")
		
		Set config = New Configuracion
		cadena = "GESTIONDOC"
		encontro = 0		
	
		' para los campos del exp actual
		Dim bdActual As String
		Dim servActual As String
		Dim expeVinculados As String 
		Dim basesVinculadas As String
		Dim servsVinculados As String	
		Dim uIdsVinculados As String
		Dim uIdExpVinculado As String

		expeVinculados = doc.Getitemvalue(CAMPO_VINCULACION_EXP)(0)
		basesVinculadas = doc.Getitemvalue(CAMPO_VINCULACION_BASES)(0)
		servsVinculados = doc.Getitemvalue(CAMPO_VINCULACION_SERVS)(0)
		uIdsVinculados  = doc.Getitemvalue(CAMPO_VINCULACION_UIDS) (0)
		
		' para los campos de los exp vinculados
		Dim expVinculados As String
		Dim basesExpVinculados As String
		Dim servsExpVinculados As String	
		Dim uIdsExpVinculados As String	
		bdActual = db.Filepath	
		servActual = conf.Getitemvalue("sHost")(0)
		
		
		Dim verificarExp As New Vector(0)
		verificarExp.values = Split(expeVinculados,";")
		Dim existe As Boolean
		existe=False
		
		
		For  i = 1 To verificarExp.cantElem
			If (nroExpABuscar=verificarExp.getElement(i))Then
				existe=true
			End If			
		Next
			
	If Not existe then	
		
		' vinculo los expedientes que selecciono el usuario al expediente actual
		For  i = 1 To claves.cantElem
			If InStr(claves.getElement(i),cadena) Then
				Set bdExpediente = config.ReferenciarBasedeDatos(claves.getElement(i))
				Set nv =  bdExpediente.Getview("(ExpedientesporTema)")
				Set expediente = nv.Getdocumentbykey(nroExpABuscar)
				If Not expediente Is Nothing  Then
					encontro =  1
				End If
				If (encontro = 1) Then					
					' seteo los numeros, las bases y servidores de los exp vinculados a los campos del exp actual
					uIdExpVinculado = expediente.Universalid
					If(expeVinculados  = "")Then
						'Call doc.Replaceitemvalue(CAMPO_VINCULACION_EXP, "")					
						'Call doc.Replaceitemvalue(CAMPO_VINCULACION_BASES, "")
						'Call doc.Replaceitemvalue(CAMPO_VINCULACION_SERVS, "")
						'Call doc.Replaceitemvalue(CAMPO_VINCULACION_UIDS,  "")	
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_EXP, nroExpABuscar)
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_BASES, pathsClave.getElement(i))
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_SERVS, servsClave.getElement(i))
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_UIDS,  uIdExpVinculado)
					Else
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_BASES,basesVinculadas & ";" & pathsClave.getElement(i))
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_SERVS,servsVinculados & ";" & servsClave.getElement(i))
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_EXP,expeVinculados & ";" & nroExpABuscar)
						Call doc.Replaceitemvalue(CAMPO_VINCULACION_UIDS,uIdsVinculados & ";" & uIdExpVinculado)
					End If 
					
					' seteo a cada uno de los expedientes vinculados la base el serv y el num del exp acutal
					expVinculados = expediente.Getitemvalue(CAMPO_VINCULACION_EXP)(0)
					basesExpVinculados = expediente.Getitemvalue(CAMPO_VINCULACION_BASES)(0)
					servsExpVinculados = expediente.Getitemvalue(CAMPO_VINCULACION_SERVS)(0)
					uIdsExpVinculados = expediente.Getitemvalue(CAMPO_VINCULACION_UIDS)(0)
					If (expVinculados  = "")Then
						'Call expediente.Replaceitemvalue(CAMPO_VINCULACION_EXP, "")
						'Call expediente.Replaceitemvalue(CAMPO_VINCULACION_BASES, "")
						'Call expediente.Replaceitemvalue(CAMPO_VINCULACION_SERVS, "")
						'Call expediente.Replaceitemvalue(CAMPO_VINCULACION_UIDS,  "")
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_EXP, nroExpActual)
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_BASES, bdActual)
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_SERVS, servActual)
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_UIDS,  doc.Universalid)
					Else
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_EXP,expVinculados & ";" & nroExpActual)
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_BASES,basesExpVinculados & ";" & bdActual)
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_SERVS,servsExpVinculados & ";" & servActual)
						Call expediente.Replaceitemvalue(CAMPO_VINCULACION_UIDS,uIdsExpVinculados & ";" & doc.Universalid)
					End If 
					Call expediente.Save(True, False)
					Exit Function	
				End If		
			End If
		Next
		
	Else
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método vincularExpActualAExpSeleccionados ","")
		Exit Function

	End If
	
		Exit Function
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método vincularExpActualAExpSeleccionados ","")
		Exit Function
	End Function
	
	'******************************************************************************************************************
	Public Property Set SolicitudDesarchivo As String
		On Error Goto HANDLER
		
		doc.replaceItemValue "SolicitudDesarchivo",SolicitudDesarchivo
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set SolicitudDesarchivo","")
		Exit Property	
	End Property		
	'******************************************************************************************************************	
	
	Public Property Get NotificacionesNroAct As Vector
		On Error Goto HANDLER
		
		Set NotificacionesNroAct = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_TNOTIF_NRO_ACT) Then
			NotificacionesNroAct.values=doc.GetItemValue(CAMPO_FCARATULA_TNOTIF_NRO_ACT)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesNroAct","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set NotificacionesUnidad As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_TNOTIF_UNIDAD,NotificacionesUnidad.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesUnidad","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get NotificacionesUnidad As Vector
		On Error Goto HANDLER
		
		Set NotificacionesUnidad = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_TNOTIF_UNIDAD) Then
			NotificacionesUnidad.values=doc.GetItemValue(CAMPO_FCARATULA_TNOTIF_UNIDAD)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesUnidad","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set NotificacionesFecha As Vector
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_TNOTIF_FECHA,NotificacionesFecha.values
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesFecha","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get NotificacionesFecha As Vector
		On Error Goto HANDLER
		
		Set NotificacionesFecha = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_TNOTIF_FECHA) Then
			NotificacionesFecha.values=doc.GetItemValue(CAMPO_FCARATULA_TNOTIF_FECHA)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesFecha","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set NotificacionesAcusaronFecha As Vector
		On Error Goto HANDLER
		
		If NotificacionesAcusaronFecha.cantElem > 0 Then
			doc.replaceItemValue CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA,NotificacionesAcusaronFecha.values	
		Else
			If doc.hasItem(CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA) Then
				doc.RemoveItem CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA
			End If
		End If		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NotificacionesAcusaronFecha","")
		Exit Property
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Get NotificacionesAcusaronFecha As Vector
		On Error Goto HANDLER
		
		Set NotificacionesAcusaronFecha=New Vector(0)
		If doc.hasItem(CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA) Then
			NotificacionesAcusaronFecha.values=doc.getItemValue(CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA)
		End If		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesAcusaronFecha","")
		Exit Property
	End Property
	
	'******************************************************************************************************************			
	'Inidice que indica a que notificación corresponde cada fecha de acuse
	Public Property Get NotificacionesAcusaronFechaInd As Vector
		On Error Goto HANDLER
		
		Set NotificacionesAcusaronFechaInd=New Vector(0)
		If doc.hasItem(CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA_IND) Then
			NotificacionesAcusaronFechaInd.values=doc.getItemValue(CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA_IND)
		End If		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificacionesAcusaronFechaInd","")
		Exit Property
	End Property
	
	'******************************************************************************************************************			
	'Inidice que indica a que notificación corresponde cada fecha de acuse
	Public Property Set NotificacionesAcusaronFechaInd As Vector
		On Error Goto HANDLER
		
		Dim vNumerico As New Vector(0),i As Integer
		If NotificacionesAcusaronFechaInd.cantElem > 0 Then
			'No entiendo por que tuve que hacer esta conversión hasta el día de hoy.- Error TIpos mezclados
			For i=1 To NotificacionesAcusaronFechaInd.CantElem
				vNumerico.insertElement Cint(NotificacionesAcusaronFechaInd.getelement(i)),i
			Next
			If doc.HasItem(CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA_IND) Then
				doc.RemoveItem CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA_IND	
			End If
			doc.replaceItemValue CAMPO_FCARATULA_TNOTIF_ACUSE_FECHA_IND,vNumerico.values
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NotificacionesAcusaronFechaInd","")
		Exit Property
	End Property
	
	'******************************************************************************************************************			
	
	
	Public Property Get NotificadosAcusaron As Vector
		On Error Goto HANDLER
		
		Set NotificadosAcusaron=New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_NOTIF_ACUSARON) Then
			NotificadosAcusaron.values=doc.GetItemValue(CAMPO_FCARATULA_NOTIF_ACUSARON)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificadosAcusaron","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set NotificadosAcusaron As Vector
		On Error Goto HANDLER
		
		If NotificadosAcusaron.cantElem > 0 Then
			doc.replaceItemValue CAMPO_FCARATULA_NOTIF_ACUSARON,NotificadosAcusaron.values	
		Else
			If doc.hasItem(CAMPO_FCARATULA_NOTIF_ACUSARON) Then
				doc.RemoveItem CAMPO_FCARATULA_NOTIF_ACUSARON
			End If
		End If		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NotificadosAcusaron","")
		Exit Property
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Get Notificados As Vector
		On Error Goto HANDLER
		
		Set Notificados=New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_NOTIF_SIN_ACUSE) Then
			Notificados.values=doc.GetItemValue(CAMPO_FCARATULA_NOTIF_SIN_ACUSE)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Notificados","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set Notificados As Vector
		On Error Goto HANDLER
		
		If Notificados.cantElem > 0 Then
			doc.replaceItemValue CAMPO_FCARATULA_NOTIF_SIN_ACUSE,Notificados.values	
		Else
			If doc.hasItem(CAMPO_FCARATULA_NOTIF_SIN_ACUSE) Then
				doc.RemoveItem CAMPO_FCARATULA_NOTIF_SIN_ACUSE
			End If
		End If		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Notificados","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Get PaqueteResponsable As String
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_PAQ_RESPONSABLE) Then
			PaqueteResponsable=doc.GetItemValue(CAMPO_FCARATULA_PAQ_RESPONSABLE)(0)	
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get PaqueteResponsable","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set PaqueteResponsable As String
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_PAQ_RESPONSABLE,PaqueteResponsable
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set PaqueteResponsable","")
		Exit Property
	End Property
	'******************************************************************************************************************		
	
	Public Property Get PaqueteEnAgregado As String
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_PAQUETE_EN_AGREGADO) Then
			PaqueteEnAgregado=doc.GetItemValue(CAMPO_FCARATULA_PAQUETE_EN_AGREGADO)(0)	
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get PaqueteEnAgregado","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set PaqueteEnAgregado As String
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_PAQUETE_EN_AGREGADO,PaqueteEnAgregado
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set PaqueteEnAgregado","")
		Exit Property
	End Property
	
	
	'******************************************************************************************************************			
	
	
	Public Property Get ReservadoPor As String
		'Devuelve el nombre del usuario que tiene reservado el expediente
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_RESERVADO_POR) Then
			ReservadoPor=doc.getItemValue(CAMPO_FCARATULA_RESERVADO_POR)(0)
		End If		
		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Propiedad Get ReservadoPor","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Set ReservadoPor As String
		'Setea el nombre del usuario que tiene reservado el expediente
		On Error Goto HANDLER		
		
		
		doc.replaceItemValue CAMPO_FCARATULA_RESERVADO_POR,ReservadoPor
		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Propiedad Set ReservadoPor","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Get PaqueteLugar As String
		On Error Goto HANDLER
		
		
		If doc.HasItem(CAMPO_FCARATULA_PAQ_LUGAR) Then
			PaqueteLugar=doc.GetItemValue(CAMPO_FCARATULA_PAQ_LUGAR)(0)	
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get PaqueteLugar","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set PaqueteLugar As String
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_PAQ_LUGAR,PaqueteLugar
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set PaqueteLugar","")
		Exit Property
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Get PaqueteFechaRecibido As Variant
		On Error Goto HANDLER
		
		
		If doc.HasItem(CAMPO_FCARATULA_PAQ_RECIBIDO) Then
			PaqueteFechaRecibido=doc.GetItemValue(CAMPO_FCARATULA_PAQ_RECIBIDO)(0)	
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get PaqueteFechaRecibido","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set PaqueteFechaRecibido As Variant
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_PAQ_RECIBIDO,PaqueteFechaRecibido
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set PaqueteFechaRecibido","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get AgregadosFecha As Vector
		On Error Goto HANDLER
		
		Set AgregadosFecha=New Vector(0)
		
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_FECHA) Then
			AgregadosFecha.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_FECHA)	
		End If
		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método Get AgregadosFecha","")
		Exit Property
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Get AgregadosActuaciones As Vector
		On Error Goto HANDLER
		
		Set AgregadosActuaciones=New Vector(0)
		
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_ACTUACION) Then
			AgregadosActuaciones.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_ACTUACION)	
		End If
		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método Get AgregadosActuaciones","")
		Exit Property
	End Property
	
	'******************************************************************************************************************				
	
	
	Public Property Get AgregadosUnidades As Vector
		On Error Goto HANDLER
		
		Set AgregadosUnidades=New Vector(0)
		
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_UNIDAD) Then
			AgregadosUnidades.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_UNIDAD)	
		End If
		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método Get AgregadosUnidades","")
		Exit Property
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Get AgregadosNros As Vector
		On Error Goto HANDLER
		
		Set AgregadosNros=New Vector(0)
		
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_NRO) Then
			AgregadosNros.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_NRO)
		End If
		
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método Get AgregadosNros","")
		Exit Property
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Set CodigoPadre As String
		'Setea el Expediente al cual se agregó
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_PADRE_DE_AGREGADO,CodigoPadre
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Actuacion - Propiedad Set CodigoPadre","")
		Exit Property	
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get CodigoPadre As String
		'Indica el Expediente al cual se agregó
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_PADRE_DE_AGREGADO) Then
			CodigoPadre=doc.GetItemValue(CAMPO_FCARATULA_PADRE_DE_AGREGADO)(0)	
		End If
		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Actuacion - Propiedad Get CodigoPadre","")
		Exit Property	
	End Property
	
	Public Property Get Document As NotesDocument
		On Error Goto HANDLER
		
		Set Document=doc
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Actuacion - Propiedad Get aBorrar","")
		Exit Property
		
	End Property
	
	Public Property Get aBorrar As Integer
		'Devuelve true si el nombre del formulario indica que la actuación debe borrarse
		'Obs: Cuando una actuación se anula (a causa de las operaciones de "Anular pase"
		'o "Devolver"), la misma deja de ser una actuación y por tanto se cambia su formulario
		'por otro que indica que es una actuación que ha sido borrada
		On Error Goto HANDLER
		
		If Instr(doc.GetItemValue(CAMPO_FORM)(0),DBSGD_CAMPO_FORM_BORRAR_PREFIJO) > 0 Then
			aBorrar=True
		Else
			aBorrar=False
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Actuacion - Propiedad Get aBorrar","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Set aBorrar As Integer
		'Setea la carátula como borrada o como activa (modificando su form)
		On Error Goto HANDLER
		
		If aBorrar Then
			doc.ReplaceItemValue CAMPO_FORM,DBSGD_CAMPO_FORM_BORRAR_PREFIJO & DBSGD_FORM_CARATULA
		Else
			doc.ReplaceItemValue CAMPO_FORM,DBSGD_FORM_CARATULA
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set aBorrar","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Set FechaArchivado As Variant
		'Indica si el expediente está marcado como Confidencial
		On Error Goto HANDLER
		
		If Isnull(FechaArchivado) Then
			If doc.HasItem(CAMPO_FCARATULA_FECHA_ARCHIVADO) Then
				doc.RemoveItem CAMPO_FCARATULA_FECHA_ARCHIVADO
			End If
		Else
			doc.replaceItemValue CAMPO_FCARATULA_FECHA_ARCHIVADO,FechaArchivado	
		End If		
		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set FechaArchivado","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get FechaArchivado As Variant
		'Indica si el expediente está marcado como Confidencial
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_FECHA_ARCHIVADO) Then
			FechaArchivado=doc.GetItemValue(CAMPO_FCARATULA_FECHA_ARCHIVADO)(0)
		End If
		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get FechaArchivado","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get Confidencial As Integer
		'Indica si el expediente está marcado como Confidencial
		On Error Goto HANDLER
		
		If doc.HasItem(DBSGD_CAMPO_FCARATULA_SEGURIDAD) Then
			Confidencial=doc.getItemValue(DBSGD_CAMPO_FCARATULA_SEGURIDAD)(0)=SEGURIDAD_CONFIDENCIAL
		Else
			Confidencial=False
		End If
		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Confidencial","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set Confidencial As Integer
		'Indica si el expediente está marcado como Confidencial
		On Error Goto HANDLER
		
		If Confidencial Then
			doc.replaceItemValue DBSGD_CAMPO_FCARATULA_SEGURIDAD,SEGURIDAD_CONFIDENCIAL
		Else
			doc.replaceItemValue DBSGD_CAMPO_FCARATULA_SEGURIDAD,SEGURIDAD_NORMAL
		End If
		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Confidencial","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get Id() As String
		'Devuelve el UniversalId del documento de Carátula
		On Error Goto HANDLER
		
		Id=doc.UniversalID
		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Id","")
		Exit Property
		
	End Property
	
'******************************************************************************************************************	
	Public Property Get NroExpSEM() As String
		'Devuelve el número de expediente correspondiente a esta carátula
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_NRO_EXPEDIENTE_SEM) Then
			NroExpSEM=doc.getItemValue(CAMPO_NRO_EXPEDIENTE_SEM)(0)	
		End If		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NroExpSEM","")
		Exit Property
		
	End Property
	
	
	'******************************************************************************************************************	
	
	Public Property Get NroExp() As String
		'Devuelve el número de expediente correspondiente a esta carátula
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_NRO_EXPEDIENTE) Then
			NroExp=doc.getItemValue(CAMPO_FCARATULA_NRO_EXPEDIENTE)(0)	
		End If		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NroExp","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get NroExpReservado() As String
		'Devuelve el número de expediente correspondiente a esta carátula
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_NRO_RESERVADO_EXPEDIENTE) Then
			NroExpReservado=doc.getItemValue(CAMPO_FCARATULA_NRO_RESERVADO_EXPEDIENTE)(0)	
		End If		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NroExpReservado","")
		Exit Property
		
	End Property
	'******************************************************************************************************************	
	
	Public Property Get anioReservado() As String
		'Devuelve el número de expediente correspondiente a esta carátula
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_ANIO_RESERVADO) Then
			anioReservado=doc.getItemValue(CAMPO_FCARATULA_ANIO_RESERVADO)(0)	
		End If		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get anioReservado","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set NroExpSEM() As String
		'Setea el número de expediente correspondiente a esta carátula
		On Error GoTo HANDLER
		
		doc.replaceItemValue CAMPO_NRO_EXPEDIENTE_SEM ,NroExpSEM
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NroExpSEM","")
		Exit Property
		
	End Property
	'******************************************************************************************************************	

	Public Property Set UrlExpSEM() As String
		'Setea el número de expediente correspondiente a esta carátula
		On Error GoTo HANDLER
		
		doc.replaceItemValue CAMPO_URL_SEM ,UrlExpSEM
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set UrlExpSEM","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get UrlExpSEM() As String
		'Devuelve el número de expediente correspondiente a esta carátula
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_URL_SEM) Then
			UrlExpSEM=doc.getItemValue(CAMPO_URL_SEM)(0)	
		End If		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CAMPO_URL_SEM","")
		Exit Property
		
	End Property
	'******************************************************************************************************************
	
	Public Property Set NroExp() As String
		'Setea el número de expediente correspondiente a esta carátula
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_NRO_EXPEDIENTE,NroExp
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NroExp","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get NroCopia() As String
		'Devuelve el número de expediente correspondiente a esta carátula
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_NRO_COPIA_EXPEDIENTE) Then
			NroCopia=doc.getItemValue(CAMPO_FCARATULA_NRO_COPIA_EXPEDIENTE)(0)	
		End If		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NroCopia","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set NroCopia() As String
		'Setea el número de expediente correspondiente a esta carátula
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_NRO_COPIA_EXPEDIENTE,NroCopia
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NroCopia","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Get Tema() As String
		'Devuelve el nombre del tema del expediente
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_TEMA) Then
			Tema=doc.getItemValue(CAMPO_FCARATULA_TEMA)(0)
		End If
		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Tema","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set Tema() As String
		'Setea el nombre del tema del expediente
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_TEMA,Tema
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Tema","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get VersionTema() As Integer
		'Devuelve el nombre del tema del expediente
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_VERSION_TEMA) Then
			VersionTema=doc.getItemValue(CAMPO_FCARATULA_VERSION_TEMA)(0)
		End If
		
		
		Exit Property		
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get VersionTema","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set VersionTema() As Integer
		'Setea el nombre del tema del expediente
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_VERSION_TEMA,VersionTema
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set VersionTema","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get Asunto() As String
		'Devuelve el asunto del expediente
		On Error Goto HANDLER
		Dim vAsunto As New Vector(0)
		
		If doc.hasItem(CAMPO_FCARATULA_ASUNTO) Then
			
			vAsunto.values=doc.getItemValue(CAMPO_FCARATULA_ASUNTO)
			Asunto = vAsunto.toString(Chr(13)&Chr(10))
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Asunto","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set Asunto() As String
		'Setea el asunto del expediente
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_ASUNTO,Asunto
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Asunto","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Get OficinaActual As String
		'Devuelve el nombre de la unidad en la que se encuentra el expediente
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_OFICINA_ACTUAL) Then
			OficinaActual=doc.getItemValue(CAMPO_FCARATULA_OFICINA_ACTUAL)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get OficinaActual","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set OficinaActual As String
		'Setea el nombre de la unidad en la que se encuentra el expediente
		On Error Goto HANDLER		
		
		doc.replaceItemValue CAMPO_FCARATULA_OFICINA_ACTUAL ,OficinaActual		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set OficinaActual","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Get OficinaAnterior As String
		'Devuelve el nombre de la unidad que actuó sobre el expediente en el paso anterior al actual
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_OFICINA_ANTERIOR) Then
			OficinaAnterior=doc.getItemValue(CAMPO_FCARATULA_OFICINA_ANTERIOR)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get OficinaAnterior","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set OficinaAnterior As String
		'Setea el nombre de la unidad que actuó sobre el expediente en el paso anterior al actual
		On Error Goto HANDLER		
		
		doc.replaceItemValue CAMPO_FCARATULA_OFICINA_ANTERIOR ,OficinaAnterior		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set OficinaAnterior","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************		
	
	Public Property Get OficinaInicial() As String
		'Devuelve el nombre de la unidad que inició el expediente
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_OFICINA_INCIAL) Then
			OficinaInicial=doc.getItemValue(CAMPO_FCARATULA_OFICINA_INCIAL)(0)
		End If				
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get OficinaInicial","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Set OficinaInicial() As String
		'Setea el nombre de la unidad que inició el expediente
		On Error Goto HANDLER		
		
		doc.replaceItemValue CAMPO_FCARATULA_OFICINA_INCIAL,OficinaInicial		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set OficinaInicial","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Get CantActuaciones() As Integer
		'Devuelve la cantidad de actuaciones del expediente
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_CANT_ACTUACIONES) Then
			CantActuaciones=Cint(doc.getItemValue(CAMPO_FCARATULA_CANT_ACTUACIONES)(0))
		End If			
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CantActuaciones","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Set CantActuaciones() As Integer
		'Setea la cantidad de actuaciones del expediente
		On Error Goto HANDLER		
		
		doc.replaceItemValue CAMPO_FCARATULA_CANT_ACTUACIONES,CantActuaciones		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set CantActuaciones","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Get Estado() As String
		'Devuelve el estado del expediente
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_ESTADO) Then
			Estado=doc.getItemValue(CAMPO_FCARATULA_ESTADO)(0)
		End If		
		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Estado","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Set Estado() As String
		'Setea el estado del expediente
		On Error Goto HANDLER		
		
		doc.replaceItemValue CAMPO_FCARATULA_ESTADO,Estado		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Estado","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Get FechaCreacion() As Variant
		'Devuelve la fecha de creación del expediente
		On Error Goto HANDLER
		
		If doc.hasItem(CAMPO_FCARATULA_FECHA_CREACION) Then
			FechaCreacion=doc.getItemValue(CAMPO_FCARATULA_FECHA_CREACION)(0)
		End If		
		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get FechaCreacion","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Set FechaCreacion() As Variant
		'Setea la fecha de creación del expediente
		On Error Goto HANDLER		
		
		doc.replaceItemValue CAMPO_FCARATULA_FECHA_CREACION,FechaCreacion		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set FechaCreacion","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Get Autores() As Vector
		'Devuelve un vector con los autores de la carátula
		On Error Goto HANDLER
		
		Dim vAutores As New Vector(0),vTransformar As New Vector(0)
		
		If doc.hasItem(CAMPO_FCARATULA_AUTORES) Then
			vAutores.values=doc.getItemValue(CAMPO_FCARATULA_AUTORES)	
			If vAutores.cantElem > 0 Then
				Dim i As Integer,nom As NotesName
				For i = 1 To vAutores.cantElem
					Set nom=New notesName(vAutores.getElement(i))
					vTransformar.insertElement nom.Abbreviated,vTransformar.cantElem + 1
				Next		
			End If			
		End If		
		Set Autores=vTransformar
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Autores","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Set Autores() As Vector
		'Setea los autores de la carátula
		On Error Goto HANDLER		
		
		Dim itAut As notesItem
		If Autores.cantElem > 0 Then
			Dim vTransformar As New Vector(0)
			Dim i As Integer,nom As NotesName
			For i = 1 To Autores.cantElem
				Set nom=New notesName(Autores.getElement(i))
				vTransformar.insertElement nom.Canonical,vTransformar.cantElem + 1
			Next	
			If doc.HasItem(CAMPO_FCARATULA_AUTORES) Then
				doc.RemoveItem CAMPO_FCARATULA_AUTORES
			End If
			Set itAut=New NotesItem(doc,CAMPO_FCARATULA_AUTORES,vTransformar.values,AUTHORS)
			'doc.replaceItemValue CAMPO_FCARATULA_AUTORES,vTransformar.values
		Else
			If doc.HasItem(CAMPO_FCARATULA_AUTORES) Then
				doc.RemoveItem CAMPO_FCARATULA_AUTORES
			End If
			Set itAut=New NotesItem(doc,CAMPO_FCARATULA_AUTORES,"",AUTHORS)
		End If
		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Autores","")
		Exit Property
		
	End Property
	
	'*****************************************************************************************************************				
	
	Public Property Set AutoresPermanentes As Vector
		'Setea los autores de la carátula
		On Error Goto HANDLER		
		
		Dim itAutores As NotesItem
		Set itAutores=New  NotesItem(doc,CAMPO_FCARATULA_AUTORES_PERMANENTES,AutoresPermanentes.values,AUTHORS)
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set AutoresPermanentes","")
		Exit Property
		
	End Property
	
	'*****************************************************************************************************************				
	
	Public Property Get AutoresPermanentes As Vector
		'Setea los autores de la carátula
		On Error Goto HANDLER		
		
		AutoresPermanentes.values=doc.getItemValue(CAMPO_FCARATULA_AUTORES_PERMANENTES)
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get AutoresPermanentes","")
		Exit Property
		
	End Property
	
	'*****************************************************************************************************************				
	
	Public Property Get Lectores() As Vector
		'Devuelve un vector con los lectores de la carátula
		On Error Goto HANDLER
		
		Dim vLectores As New Vector(0)
		
		If doc.hasItem(CAMPO_FCARATULA_LECTORES) Then
			vLectores.values=doc.getItemValue(CAMPO_FCARATULA_LECTORES)	
		End If		
		Set Lectores=vLectores
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Lectores","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Set Lectores() As Vector
		'Setea los lectores de la carátula
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_LECTORES,Lectores.values
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Lectores","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Get Seguridad() As String
		'Devuelve el tipo de seguridad del expediente (normal o confidencial)
		On Error Goto HANDLER		
		
		If doc.hasItem(CAMPO_FCARATULA_SEGURIDAD) Then
			Seguridad=doc.getItemValue(CAMPO_FCARATULA_SEGURIDAD)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Seguridad","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************			
	
	Public Property Set Seguridad() As String
		'Setea el tipo de seguridad del expediente (normal o confidencial)
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_SEGURIDAD, Seguridad		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Seguridad","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Get FechaPase As Variant
		'Devuelve la última fecha de pase del expediente
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_FECHA_PASE) Then
			FechaPase=doc.getItemValue(CAMPO_FCARATULA_FECHA_PASE)(0)	
		End If
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get FechaPase","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Set FechaPase As Variant
		'Setea la última fecha de pase del expediente
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_FECHA_PASE, FechaPase
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set FechaPase","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Set Firmantes As Vector
		'Son las personas a quien se va a notificar para que firmen el expediente
		On Error Goto HANDLER
		
		doc.replaceItemValue CAMPO_FCARATULA_FIRMANTES, Firmantes.values
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Firmantes","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************				
	
	Public Property Get Firmantes As Vector
		'Son las personas a quien se va a notificar para que firmen el expediente
		On Error Goto HANDLER
		
		Dim vFir As New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_FIRMANTES) Then
			vFir.values=doc.getItemValue(CAMPO_FCARATULA_FIRMANTES)
		End If
		Set Firmantes=vFir
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Firmantes","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	'******************************************************************************************************************	
	'******************************************************************************************************************	
	
	'Privadas	
	
	Private Sub SetearDbGestionDoc(Byval anio As Integer)
		'Si aún no está seteada, setea la base de gestión documental que corresponda según el anio que recibe
		On Error Goto HANDLER
		
		Dim c As New Configuracion	
		
		If db Is Nothing Then
			If Not Isnumeric(anio) Then Error ERROR_ANIO_NOTHING, MSG_ERROR_ANIO_NOTHING
			
			Set db = c.BaseDeDatosAnio(anio,CLAVE_DBTEMPLATEGESTIONDOC,CLAVE_DBGESTIONDOC, false)
			If Not db.isOpen Then Error ERROR_DB_NOT_OPEN, MSG_ERROR_DB_NOT_OPEN+" "+CLAVE_DBGESTIONDOC
		End If
		
		Exit Sub	
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Procedimiento SetearDbGestionDoc","")
		Exit Sub
		
	End Sub
	
	'******************************************************************************************************************	
	
	Private Function getDocCaratulaPorNro(sNroExpediente As String) As notesDocument	
		'Busca el documento Caratula correspondiente al expediente número sNroExpediente y lo devuelve
		On Error Goto HANDLER
		Dim vCaratulas As notesview
		Set vCaratulas=db.getView(DBSGD_VISTA_BUSQ_CARATULA) 
		
		If Not vCaratulas Is Nothing Then
			vCaratulas.AutoUpdate=False			
			Set doc=vCaratulas.getdocumentByKey(sNroExpediente,True)				
			vCaratulas.AutoUpdate=True			
			Set getDocCaratulaPorNro=doc	
		Else
			Error ERROR_VIEW_NOT_FOUND,MSG_ERROR_VIEW_NOT_FOUND & " " & DBSGD_VISTA_BUSQ_CARATULA
		End If
		
		
		Exit Function
		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Procedimiento getDocCaratulaPorNro " & sNroExpediente,"")
		Exit Function
	End Function
	
	'******************************************************************************************************************	
	
	Private Function getDocCaratulaPorId(sIDExpediente As String)As notesDocument
		'Busca el documento Caratula correspondiente al expediente con UniversalID sIDExpediente y lo devuelve
		On Error Goto HANDLER
		
		Set getDocCaratulaPorId=db.getDocumentByUNID(sIDExpediente)	

		Exit Function
		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Procedimiento getDocCaratulaPorId " & sIDExpediente,"")
		Exit Function
	End Function
	
	'******************************************************************************************************************	
	
	Private Sub addPaqHistorial(fFechaRecibido As Variant,sLugar As String,sResponsable As String)
		On Error Goto HANDLER
		
		Dim itFechas As NotesItem
		If doc.HasItem(CAMPO_FCARATULA_HPAQ_FECHAS) Then
			Dim vFechas As New Vector(0)
			vFechas.values=doc.GetItemValue(CAMPO_FCARATULA_HPAQ_FECHAS)
			vFechas.insertElement fFechaRecibido,vFechas.cantElem + 1
			doc.replaceItemValue CAMPO_FCARATULA_HPAQ_FECHAS,vFechas.values
		Else
			Set itFechas=New notesItem(doc,CAMPO_FCARATULA_HPAQ_FECHAS,fFechaRecibido)
		End If
		
		
		Dim itLugares As NotesItem
		If doc.HasItem(CAMPO_FCARATULA_HPAQ_LUGARES) Then
			Set itLugares=doc.GetFirstItem(CAMPO_FCARATULA_HPAQ_LUGARES)
			itLugares.AppendToTextList sLugar
		Else
			Set itLugares=New notesItem(doc,CAMPO_FCARATULA_HPAQ_LUGARES,sLugar)
		End If		
		
		Dim itResponsables As NotesItem
		If doc.HasItem(CAMPO_FCARATULA_HPAQ_RESPONSABLES) Then
			Set itResponsables=doc.GetFirstItem(CAMPO_FCARATULA_HPAQ_RESPONSABLES)
			itResponsables.AppendToTextList sResponsable
		Else
			Set itResponsables=New notesItem(doc,CAMPO_FCARATULA_HPAQ_RESPONSABLES,sResponsable)
		End If
			
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método addPaqHistorial","")
		Exit Sub
	End Sub
	
	'******************************************************************************************************************	
	'******************************************************************************************************************	
	'******************************************************************************************************************	
	
	
	'CONSTRUCTOR
	
	Public Sub new(Byval sNroExpediente As String, Byval bCrear As Integer)
		'Si bCrear = True, devuelve el doc carátula con universalid sNroExpediente
		'Si bCrear = False, devuelve el doc caratula con numero de expediente sNroExpediente
		On Error Goto HANDLER
		
		Dim c As New Configuracion
		If sNroExpediente <> NRO_EX_VACIO Then
			If bCrear Then   'vino el universalid
				
				'Call SetearDbGestionDoc(Year(Today))
				'Set doc=getDocCaratulaPorId(sNroExpediente)
				Set doc = obtenerDocCaratulaByUNID(sNroExpediente)
				
			Else   'vino el nro de expediente
				Set db = c.BaseDeDatosNroDoc(sNroExpediente,NUMERADOR_EXP,CLAVE_DBTEMPLATEGESTIONDOC,CLAVE_DBGESTIONDOC)
						
				Set doc=getDocCaratulaPorNro(sNroExpediente)
				If doc Is Nothing Then
					'Podría estar achivado
					Set db = c.BaseDeDatosNroDoc(sNroExpediente,NUMERADOR_EXP,CLAVE_DBARCHIVO_TEMPLATE	,CLAVE_DBARCHIVO)
					Set doc=getDocCaratulaPorNro(sNroExpediente)
				End If
			End If
			If doc Is Nothing Then	
				Error ERROR_DOCUMENT_NOT_FOUND,MSG_ERROR_DOCUMENT_NOT_FOUND & " : " & sNroExpediente
			End If
		End If
		
		
		Exit Sub	
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Procedimiento New " & sNroExpediente,"")
		Exit Sub	
	End Sub	
	
	%REM
		Sub QuitarVinculo
		Description: Comments for Sub
	%END REM
	Public Sub QuitarVinculo(sNroExpDes As String)
		On Error GoTo handler
		Dim expeVinculados As New Vector(0) 
		Dim basesVinculadas As New Vector(0)
		Dim servsVinculados As New Vector(0)	
		Dim uIdsVinculados As New Vector(0)		

		expeVinculados.values = Split(doc.Getitemvalue(CAMPO_VINCULACION_EXP)(0),";")
		basesVinculadas.values = Split(doc.Getitemvalue(CAMPO_VINCULACION_BASES)(0),";")
		servsVinculados.values = Split(doc.Getitemvalue(CAMPO_VINCULACION_SERVS)(0),";")
		uIdsVinculados.values  = Split(doc.Getitemvalue(CAMPO_VINCULACION_UIDS)(0),";")
		
		Dim pos As Long
		pos = 0
		
		If expeVinculados.isMember(sNroExpDes, Pos, true) Then
			
			Call expeVinculados.deleteElement(pos)
			Call basesVinculadas.deleteElement(Pos)
			Call servsVinculados.deleteElement(pos)
			Call uIdsVinculados.deleteElement(Pos)
			Call doc.Replaceitemvalue(CAMPO_VINCULACION_EXP, expeVinculados.ToString(";"))
			Call doc.Replaceitemvalue(CAMPO_VINCULACION_BASES, basesVinculadas.ToString(";"))
			Call doc.Replaceitemvalue(CAMPO_VINCULACION_SERVS, servsVinculados.ToString(";"))
			Call doc.Replaceitemvalue(CAMPO_VINCULACION_UIDS, uIdsVinculados.ToString(";"))
		End If
		Exit sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Procedimiento QuitarVinculo" ,"")
		Exit Sub
	End Sub
	%REM
		Function obtenerDocCaratulaByUNID
		Description: Comments for Function
	%END REM
	Public Function obtenerDocCaratulaByUNID(unid As String) As NotesDocument
		On Error GoTo handler
		Dim i As Integer
		Dim encontre As Boolean
		encontre = false
		i = -1 
		While Not encontre
siguiente:
			i = i+1
			Set db = nothing
			Call SetearDbGestionDoc(Year(Today) - i)
			Set obtenerDocCaratulaByUNID = getDocCaratulaPorId(unid)
			encontre = True
		Wend
		Exit function
handler:
		If Err = 4091 Then
			Resume siguiente
		Else
			Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Función obtenerDocCaratulaByUNID " & unid,"")
		End If
	End Function
	
	'******************************************************************************************************************	
	
	Public Sub Inicializar(docCar As NotesDocument)
		On Error Goto HANDLER
		
		If docCar Is Nothing Then	
			Error ERROR_DOCUMENT_NOT_FOUND,MSG_ERROR_DOCUMENT_NOT_FOUND
		Else
			Set doc=docCar
		End If
		
		
		Exit Sub	
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Carátula - Procedimiento Inicializar","")
		Exit Sub		
	End Sub
	
	'******************************************************************************************************************	
	
	'METODOS	
	
	Public Function save()
		'Salva el documento carátula
		On Error Goto HANDLER
		
		doc.save True,False
		
		Exit Function
HANDLER:
		Call RegistraryGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método Save","")
		Exit Function
	End Function
	
	'******************************************************************************************************************	
	
	Public Function getRecorridoColumna(Byval nColumna As Integer) As Vector
		'Devuelve los valores de la columna indicada para la tabla de recorrido
		On Error Goto HANDLER
		
		Set getRecorridoColumna= New Vector(0)
		Select Case(nColumna)
			Case 1:
				getRecorridoColumna.values=doc.getItemValue(CAMPO_FCARATULA_RECORRIDO_ENTRADA)
			Case 2:
				getRecorridoColumna.values=doc.getItemValue(CAMPO_FCARATULA_RECORRIDO_SALIDA)
			Case 3:
				getRecorridoColumna.values=doc.getItemValue(CAMPO_FCARATULA_RECORRIDO_UNIDAD)
			Case Else
				
		End Select
		
		Exit Function
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método getRecorridoColumna","")
		Exit Function
	End Function
	
	'******************************************************************************************************************			
	
	Public Function setRecorridoColumna(Byval nColumna As Integer,vColumna As Vector)
		'Setea los valores de la columna indicada para la tabla de recorrido con los de vColumna
		On Error Goto HANDLER
		
		Select Case(nColumna)
			Case 1:
				doc.replaceItemValue CAMPO_FCARATULA_RECORRIDO_ENTRADA,vColumna.values
			Case 2:
				doc.replaceItemValue CAMPO_FCARATULA_RECORRIDO_SALIDA,vColumna.values
			Case 3:
				doc.replaceItemValue CAMPO_FCARATULA_RECORRIDO_UNIDAD,vColumna.values
			Case Else
				
		End Select
		
		Exit Function
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método setRecorridoColumna","")
		Exit Function
	End Function
	
	'******************************************************************************************************************			
	
	Public Sub addRecorrido(Byval fechaSalida As Variant, Byval fechaRecibido As Variant, sUnidad As String)
		'Agrega una línea a la tabla de recorrido
		On Error Goto HANDLER
		
		Dim vSalidas As New Vector(0),vEntradas As New Vector(0)
		Dim iEntrada As notesItem, iSalida As notesItem,iUnidad As notesItem
		
		If doc.hasItem(CAMPO_FCARATULA_RECORRIDO_ENTRADA) Then
			Set iEntrada= doc.getFirstItem(CAMPO_FCARATULA_RECORRIDO_ENTRADA)	
			vEntradas.values=iEntrada.Values
			vEntradas.insertElement fechaRecibido,vEntradas.cantElem + 1
			iEntrada.Values=vEntradas.values
		Else
			Set iEntrada= New notesItem(doc,CAMPO_FCARATULA_RECORRIDO_ENTRADA,fechaRecibido)	
		End If
		
		
		If doc.hasItem(CAMPO_FCARATULA_RECORRIDO_SALIDA) Then
			Set iSalida= doc.getFirstItem(CAMPO_FCARATULA_RECORRIDO_SALIDA)	
			vSalidas.values=iSalida.Values
			vSalidas.insertElement fechaSalida,vSalidas.cantElem + 1
			iSalida.Values=vSalidas.values
		Else
			Set iSalida= New notesItem(doc,CAMPO_FCARATULA_RECORRIDO_SALIDA,Now)	
		End If
		If doc.hasItem(CAMPO_FCARATULA_RECORRIDO_UNIDAD) Then
			Set iUnidad= doc.getFirstItem(CAMPO_FCARATULA_RECORRIDO_UNIDAD)	
			iUnidad.AppendToTextList sUnidad
		Else
			Set iUnidad= New notesItem(doc,CAMPO_FCARATULA_RECORRIDO_UNIDAD,sUnidad)	
		End If
		
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método addRecorrido","")
		Exit Sub
		
	End Sub
	
	'******************************************************************************************************************			
	
	Public Sub addLog(vLog As Vector)
		'vLog={Operacion, usuario, fecha-hora}
		'Agrega una línea al log
		
		'Set campos
		Dim iOperacion As notesItem,iUsuario As notesItem,iFechaHora As notesItem
		If doc.hasItem(CAMPO_FCARATULA_LOG_OPERACION) Then
			Set iOperacion= doc.getFirstItem(CAMPO_FCARATULA_LOG_OPERACION)	
		Else
			Set iOperacion= New notesItem(doc,CAMPO_FCARATULA_LOG_OPERACION,"")	
		End If
		If doc.hasItem(CAMPO_FCARATULA_LOG_USUARIO) Then
			Set iUsuario= doc.getFirstItem(CAMPO_FCARATULA_LOG_USUARIO)	
		Else
			Set iUsuario= New notesItem(doc,CAMPO_FCARATULA_LOG_USUARIO,"")	
		End If
		If doc.hasItem(CAMPO_FCARATULA_LOG_FECHAHORA) Then
			Set iFechaHora= doc.getFirstItem(CAMPO_FCARATULA_LOG_FECHAHORA)	
		Else
			Set iFechaHora= New notesItem(doc,CAMPO_FCARATULA_LOG_FECHAHORA,"")	
		End If		
		
		'Agrego LOG
		Call iOperacion.appendToTextList(vLog.getElement(1))	
		Call iUsuario.appendToTextList(vLog.getElement(2))
		Call iFechaHora.appendToTextList(vLog.getElement(3))
		
	End Sub
	
	'******************************************************************************************************************			
	
	Public Sub delListaAgregados(sNroExp As String)
		On Error Goto HANDLER		
		
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_NRO) Then
			Dim vNros As New Vector(0),posNro As Long
			vNros.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_NRO)
			If vNros.isMember(sNroExp,posNro,False) Then
				vNros.deleteElement posNro
				
				Dim vUnidades As New Vector(0),vFechas As New Vector(0)
				Dim vActuaciones As New Vector(0)
				vUnidades.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_UNIDAD)
				vFechas.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_FECHA)
				vActuaciones.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_ACTUACION)
				
				If vUnidades.cantElem >= posNro Then
					vUnidades.deleteElement posNro	
				End If			
				If vFechas.cantElem >= posNro Then
					vFechas.deleteElement posNro	
				End If			
				
				If vActuaciones.cantElem >= posNro Then
					vActuaciones.deleteElement posNro	
				End If			
				
				doc.ReplaceItemValue CAMPO_FCARATULA_AGREGADOS_NRO,vNros.values
				doc.ReplaceItemValue CAMPO_FCARATULA_AGREGADOS_UNIDAD,vUnidades.values
				doc.ReplaceItemValue CAMPO_FCARATULA_AGREGADOS_FECHA,vFechas.values
				doc.ReplaceItemValue CAMPO_FCARATULA_AGREGADOS_ACTUACION,vActuaciones.values
			End If			
		End If	
		
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método delListaAgregados","")
		Exit Sub
	End Sub
	
	'******************************************************************************************************************			
	
	Public Sub addListaAgregados(sNroExp As String,sUnidadAgregante As String,nroAct As Integer)
		On Error Goto HANDLER
		
		Dim itNros As NotesItem
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_NRO) Then
			Set itNros=doc.GetFirstItem(CAMPO_FCARATULA_AGREGADOS_NRO)
			itNros.AppendToTextList sNroExp
		Else
			Set itNros=New notesItem(doc,CAMPO_FCARATULA_AGREGADOS_NRO,sNroExp)
		End If
		
		
		Dim itUnidades As NotesItem
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_UNIDAD) Then
			Set itUnidades=doc.GetFirstItem(CAMPO_FCARATULA_AGREGADOS_UNIDAD)
			itUnidades.AppendToTextList sUnidadAgregante
		Else
			Set itUnidades=New notesItem(doc,CAMPO_FCARATULA_AGREGADOS_UNIDAD,sUnidadAgregante)
		End If		
		
		Dim itActuaciones As NotesItem
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_ACTUACION) Then
			Set itActuaciones=doc.GetFirstItem(CAMPO_FCARATULA_AGREGADOS_ACTUACION)
			itActuaciones.AppendToTextList Cstr(nroAct)
		Else
			Set itActuaciones=New notesItem(doc,CAMPO_FCARATULA_AGREGADOS_ACTUACION,Cstr(nroAct))
		End If
		
		'Nuevo 8/12/2004: Diego
		Dim itFechas As NotesItem
		If doc.HasItem(CAMPO_FCARATULA_AGREGADOS_FECHA) Then
			
			Dim vFechasAntes As New Vector(0),i As Integer
			vFechasAntes.values=doc.GetItemValue(CAMPO_FCARATULA_AGREGADOS_FECHA)
			Dim vFechas As New Vector(0),tmpFecha As NotesDateTime
			If vFechasAntes.cantElem > 0 Then
				For i= 1 To vFechasAntes.cantElem
					Set tmpFecha=New NotesDateTime(vFechasAntes.getElement(i))
					vFechas.insertElement Cdat(tmpFecha.DateOnly),vFechas.cantElem + 1
				Next	
			End If
			Set tmpFecha=New NotesDateTime(Today)
			vFechas.insertElement Cdat(tmpFecha.DateOnly),vFechas.cantElem + 1
			
			doc.removeItem CAMPO_FCARATULA_AGREGADOS_FECHA
			doc.replaceItemValue CAMPO_FCARATULA_AGREGADOS_FECHA,vFechas.values
		Else
			Set itFechas=New notesItem(doc,CAMPO_FCARATULA_AGREGADOS_FECHA,Today)
		End If
		
		
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método addListaAgregados","")
		Exit Sub
	End Sub
	
	
	'******************************************************************************************************************			
	
	Public Sub setPaquete(fFechaRecibido As Variant,sLugar As String,sResponsable As String)
		On Error Goto HANDLER
		
		
		addPaqHistorial Me.PaqueteFechaRecibido,Me.PaqueteLugar ,Me.PaqueteResponsable
		Me.PaqueteFechaRecibido=fFechaRecibido
		Me.PaqueteLugar=sLugar
		Me.PaqueteResponsable=sResponsable
		
		
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método addListaAgregados","")
		Exit Sub
	End Sub
	
	'******************************************************************************************************************				
	
	Public Sub addPadre(sNroExp As String)
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_PADRE_DE_AGREGADO) Then
			Dim vPadres As New Vector(0)			
			vPadres.values=doc.getItemValue(CAMPO_FCARATULA_PADRE_DE_AGREGADO)
			vPadres.insertElement sNroExp,vPadres.cantElem + 1
			doc.replaceItemValue CAMPO_FCARATULA_PADRE_DE_AGREGADO,vPadres.values
		Else
			doc.replaceItemValue CAMPO_FCARATULA_PADRE_DE_AGREGADO,sNroExp
		End If
		
		
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método addPadre","")
		Exit Sub			
	End Sub
	
	'******************************************************************************************************************
	Public Function PopPadre() As String
		On Error Goto HANDLER
		
		If doc.HasItem(CAMPO_FCARATULA_PADRE_DE_AGREGADO) Then
			Dim vPadres As New Vector(0)			
			vPadres.values=doc.getItemValue(CAMPO_FCARATULA_PADRE_DE_AGREGADO)
			If vPadres.cantElem > 0 Then
				PopPadre=vPadres.getElement(vPadres.cantElem)
				vPadres.deleteElement vPadres.cantElem	
				doc.replaceItemValue CAMPO_FCARATULA_PADRE_DE_AGREGADO,vPadres.values
			End If
		End If
		
		
		Exit Function
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método addPadre","")
		Exit Function
	End Function
	
	
	'******************************************************************************************************************				
	
	Public Property Get BaseDeDatos As NotesDatabase
		Set BasedeDatos= db
	End Property
	
	'******************************************************************************************************************
	
	Public Property Get AvisarSolicitante As Boolean
		' retorna true si el radio button CAMPO_AVISAR_SOLICITANTE esta seleccionado
		On Error Goto handler
		If doc.getItemValue(CAMPO_AVISAR_SOLICITANTE)(0)  = "Si" Then
			AvisarSolicitante = True
		Else
			AvisarSolicitante = False
		End If
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get AvisarSolicitante","")
	End Property
	'******************************************************************************************************************	
	Public Property Set AvisarSolicitante As Boolean
		On Error Goto handler
		If AvisarSolicitante Then
			doc.replaceItemValue CAMPO_AVISAR_SOLICITANTE, "Si"
		Else
			doc.replaceItemValue CAMPO_AVISAR_SOLICITANTE, "No"
		End If
		Exit Property
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set AvisarSolicitante","")
	End Property
	'******************************************************************************************************************	
	
	Public Property Get CorreosAvisos As Vector
		On Error Goto HANDLER
		
		Set CorreosAvisos = New Vector(0)
		If doc.HasItem(CAMPO_CORREOS_AVISOS) Then
			CorreosAvisos.values = doc.GetItemValue(CAMPO_CORREOS_AVISOS)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisos","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set CorreosAvisos As Vector
		On Error Goto HANDLER
		doc.replaceItemValue CAMPO_CORREOS_AVISOS,CorreosAvisos.values
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisos","")
		Exit Property
	End Property
	'******************************************************************************************************************	
	
	Public Property Get CelularesAvisos As Vector
		On Error Goto HANDLER
		
		Set CelularesAvisos = New Vector(0)
		If doc.HasItem(CAMPO_CELULARES_AVISOS) Then
			CelularesAvisos.values = doc.GetItemValue(CAMPO_CELULARES_AVISOS)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CelularesAvisos","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set CelularesAvisos As Vector
		On Error Goto HANDLER
		doc.replaceItemValue CAMPO_CELULARES_AVISOS,CelularesAvisos.values
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CelularesAvisos","")
		Exit Property
	End Property	
	'******************************************************************************************************************	
	
	Public Property Get TelefonosAvisos As Vector
		On Error Goto HANDLER
		
		Set TelefonosAvisos = New Vector(0)
		If doc.HasItem(CAMPO_TELEFONOS_AVISOS) Then
			TelefonosAvisos.values = doc.GetItemValue(CAMPO_TELEFONOS_AVISOS)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get TelefonosAvisos","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set TelefonosAvisos As Vector
		On Error Goto HANDLER
		doc.replaceItemValue CAMPO_TELEFONOS_AVISOS,TelefonosAvisos.values
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get TelefonosAvisos","")
		Exit Property
	End Property	
	
	'******************************************************************************************************************	
	
	Public Property Get UnidadesAvisos As Vector
		On Error Goto HANDLER
		
		Set UnidadesAvisos = New Vector(0)
		If doc.HasItem(CAMPO_UNIDADES_AVISOS) Then
			UnidadesAvisos.values = doc.GetItemValue(CAMPO_UNIDADES_AVISOS)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get UnidadesAvisos","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set UnidadesAvisos As Vector
		On Error Goto HANDLER
		doc.replaceItemValue CAMPO_UNIDADES_AVISOS,UnidadesAvisos.values
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get UnidadesAvisos","")
		Exit Property
	End Property
	
	'******************************************************************************************************************
	
	Public Property Get TiempoAvisos As String
		On Error Goto handler
		TiempoAvisos = doc.GetItemValue(CAMPO_TIEMPO_AVISOS)(0)
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get TiempoAvisos","")
		Exit Property
	End Property
	
	'*****************************************************************************************************************
	
	Public Property Set TiempoAvisos As String
		On Error Goto handler
		doc.ReplaceItemValue CAMPO_TIEMPO_AVISOS, TiempoAvisos
		Exit Property
handler: 
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get TiempoAvisos","")
		Exit Property		
	End Property	
	'*****************************************************************************************************************		

	Public Property Get CorreosAvisosManualQuienEnvia As Vector
		On Error GoTo HANDLER
		
		Set CorreosAvisosManualQuienEnvia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_QUIEN_ENVIA_AVISO_M) Then
			CorreosAvisosManualQuienEnvia.values = doc.GetItemValue(CAMPO_FCARATULA_QUIEN_ENVIA_AVISO_M)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisosManualQuienEnvia","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set CorreosAvisosManualQuienEnvia As Vector
		On Error GoTo HANDLER
		doc.replaceItemValue CAMPO_FCARATULA_QUIEN_ENVIA_AVISO_M,CorreosAvisosManualQuienEnvia.values
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisosManualQuienEnvia","")
		Exit Property
	End Property
	'******************************************************************************************************************	
	
	Public Property Get CorreosAvisosManualCuandoEnvia As Vector
		On Error GoTo HANDLER
		
		Set CorreosAvisosManualCuandoEnvia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_CUANDO_ENVIA_AVISO_M) Then
			CorreosAvisosManualCuandoEnvia.values = doc.GetItemValue(CAMPO_FCARATULA_CUANDO_ENVIA_AVISO_M)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisosManualCuandoEnvia","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set CorreosAvisosManualCuandoEnvia As Vector
		On Error GoTo HANDLER
		doc.replaceItemValue CAMPO_FCARATULA_CUANDO_ENVIA_AVISO_M,CorreosAvisosManualCuandoEnvia.values
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisosManualCuandoEnvia","")
		Exit Property
	End Property
	'******************************************************************************************************************	
	
	Public Property Get CorreosAvisosManualAQuienEnvia As Vector
		On Error GoTo HANDLER
		
		Set CorreosAvisosManualAQuienEnvia = New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_A_QUIEN_ENVIA_AVISO_M) Then
			CorreosAvisosManualAQuienEnvia.values = doc.GetItemValue(CAMPO_FCARATULA_A_QUIEN_ENVIA_AVISO_M)
		End If
		
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisosManualAQuienEnvia","")
		Exit Property
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set CorreosAvisosManualAQuienEnvia As Vector
		On Error GoTo HANDLER
		doc.replaceItemValue CAMPO_FCARATULA_A_QUIEN_ENVIA_AVISO_M,CorreosAvisosManualAQuienEnvia.values
		Exit Property
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get CorreosAvisosManualAQuienEnvia","")
		Exit Property
	End Property
	'******************************************************************************************************************	
	Public Property Get Bloqueante As String
		'Devuelve el nombre de la unidad en la que se encuentra el expediente
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_INTEG_FORM_BLOQ) Then
			Bloqueante=doc.getItemValue(CAMPO_INTEG_FORM_BLOQ)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Bloqueante","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set Bloqueante As String
	'Setea el nombre de la unidad en la que se encuentra el expediente
		On Error GoTo HANDLER	

			doc.replaceItemValue CAMPO_INTEG_FORM_BLOQ ,Bloqueante	

		Exit Property	
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Bloqueante","")
		Exit Property

	End Property
	
	'******************************************************************************************************************		
	Public Property Get PathWF As String
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_INTEG_FORM_PATH_WF) Then
			PathWF=doc.getItemValue(CAMPO_INTEG_FORM_PATH_WF)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get PathWF","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set PathWF As String
		On Error GoTo HANDLER		
		
		doc.replaceItemValue CAMPO_INTEG_FORM_PATH_WF ,PathWF
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set PathWF","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************		
	Public Property Get NroFormulario As String
		'Devuelve el nombre de la unidad en la que se encuentra el expediente
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_INTEG_FORM_NRO_FORM) Then
			NroFormulario=doc.getItemValue(CAMPO_INTEG_FORM_NRO_FORM)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get NroFormulario","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set NroFormulario As String
		'Setea el nombre de la unidad en la que se encuentra el expediente
		On Error GoTo HANDLER		
		
		doc.replaceItemValue CAMPO_INTEG_FORM_NRO_FORM ,NroFormulario		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set NroFormulario","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************		
	Public Property Get Usuario As String
		'Devuelve el nombre de la unidad en la que se encuentra el expediente
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_INTEG_FORM_USER) Then
			Usuario=doc.getItemValue(CAMPO_INTEG_FORM_BLOQ)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Usuario","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set Usuario As String
		'Setea el nombre de la unidad en la que se encuentra el expediente
		On Error GoTo HANDLER		
		
		doc.replaceItemValue CAMPO_INTEG_FORM_USER ,Usuario		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Usuario","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************		
	Public Property Get Seccion As String
		On Error GoTo HANDLER
		
		If doc.hasItem(CAMPO_INTEG_FORM_SECCION) Then
			Seccion=doc.getItemValue(CAMPO_INTEG_FORM_SECCION)(0)
		End If		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Get Seccion","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************	
	
	Public Property Set Seccion As String
		On Error GoTo HANDLER		
		
		doc.replaceItemValue CAMPO_INTEG_FORM_SECCION ,Seccion		
		
		Exit Property		
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Propiedad Set Seccion","")
		Exit Property
		
	End Property
	
	'******************************************************************************************************************		
	
	Public Sub DelLogAgregados(nroActuacion As Integer)
		On Error Goto handler
		Dim vActuacion As New Vector(0), vFecha As New Vector(0), vUsuario As New Vector(0)
		Dim vOficina As New Vector(0), vNroExp As New Vector(0), vOperacion As New Vector(0)
		Dim pos As Long
		
		vActuacion.values = doc.GetItemValue(CAMPO_FCARATULA_AGR_ACTUACION)
		vFecha.values = doc.GetItemValue(CAMPO_FCARATULA_AGR_FECHA)
		vUsuario.values = doc.GetItemValue(CAMPO_FCARATULA_AGR_USUARIO)
		vOficina.values = doc.GetItemValue(CAMPO_FCARATULA_AGR_OFICINA)
		vNroExp.values = doc.GetItemValue(CAMPO_FCARATULA_AGR_NROEXP)
		vOperacion.values = doc.GetItemValue(CAMPO_FCARATULA_AGR_OPERACION)
		pos=0
		While vActuacion.isMember(Cstr(nroActuacion),pos,True) 
			vActuacion.deleteElement pos
			vFecha.deleteElement pos
			vUsuario.deleteElement pos
			vOficina.deleteElement pos
			vNroExp.deleteElement pos
			vOperacion.deleteElement pos
			pos=0
		Wend
		doc.ReplaceItemValue CAMPO_FCARATULA_AGR_ACTUACION, vActuacion.values
		doc.ReplaceItemValue CAMPO_FCARATULA_AGR_FECHA, vFecha.values
		doc.ReplaceItemValue CAMPO_FCARATULA_AGR_USUARIO, vUsuario.values
		doc.ReplaceItemValue CAMPO_FCARATULA_AGR_OFICINA, vOficina.values
		doc.ReplaceItemValue CAMPO_FCARATULA_AGR_NROEXP, vNroExp.values
		doc.ReplaceItemValue CAMPO_FCARATULA_AGR_OPERACION, vOperacion.values
		Exit Sub
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método DelLogAgregados","")
		Exit Sub		
	End Sub
	'******************************************************************************************************************				
	
	Public Sub AddLogAgregados(sNroExp As String,usrActua As String,agregar As Integer,nroActuacion As Integer)
		'Agrega filas a la tabla de log de Agregaciones y Desagregaciones
		'agregar=true indica Agregar, de lo contrario indica Desagregar
		On Error Goto HANDLER
		
		Dim i As Integer,posEliminar As Long
		Dim oUnidad As UnidadExp
		posEliminar=0
		
		Dim vTmp As New Vector(0)
		'		If posEliminar = 0 Then
		If doc.HasItem(CAMPO_FCARATULA_AGR_FECHA) Then
			vTmp.values=doc.getItemValue(CAMPO_FCARATULA_AGR_FECHA)
		End If
		vTmp.insertElement   Now,vTmp.cantElem + 1
		doc.replaceItemValue CAMPO_FCARATULA_AGR_FECHA,vTmp.values
		
		Set vTmp =New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_AGR_USUARIO) Then
			vTmp.values=doc.getItemValue(CAMPO_FCARATULA_AGR_USUARIO)
		End If
		vTmp.insertElement   usrActua,vTmp.cantElem + 1
		doc.replaceItemValue CAMPO_FCARATULA_AGR_USUARIO,vTmp.values
		
		Set vTmp =New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_AGR_OFICINA) Then
			vTmp.values=doc.getItemValue(CAMPO_FCARATULA_AGR_OFICINA)
		End If
		
		Set oUnidad = New UnidadExp(Me.OficinaActual)
		vTmp.insertElement   oUnidad.NombreActual,vTmp.cantElem + 1
		doc.replaceItemValue CAMPO_FCARATULA_AGR_OFICINA,vTmp.values
		
		Set vTmp =New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_AGR_NROEXP) Then
			vTmp.values=doc.getItemValue(CAMPO_FCARATULA_AGR_NROEXP)
		End If
		vTmp.insertElement   sNroExp,vTmp.cantElem + 1
		doc.replaceItemValue CAMPO_FCARATULA_AGR_NROEXP,vTmp.values
		
		Set vTmp =New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_AGR_ACTUACION) Then
			vTmp.values=doc.getItemValue(CAMPO_FCARATULA_AGR_ACTUACION)
		End If
		vTmp.insertElement   Cstr(nroActuacion),vTmp.cantElem + 1
		doc.replaceItemValue CAMPO_FCARATULA_AGR_ACTUACION,vTmp.values
		
		
		Set vTmp =New Vector(0)
		If doc.HasItem(CAMPO_FCARATULA_AGR_OPERACION) Then
			vTmp.values=doc.getItemValue(CAMPO_FCARATULA_AGR_OPERACION)
		End If
		If agregar Then
			vTmp.insertElement   "Agregado",vTmp.cantElem + 1	
		Else
			vTmp.insertElement   "Desagregado",vTmp.cantElem + 1
		End If		
		doc.replaceItemValue CAMPO_FCARATULA_AGR_OPERACION,vTmp.values				
		
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método AddLogAgregados","")
		Exit Sub
	End Sub
	
	'******************************************************************************************************************				
	Public Sub addAnexo ( nroAct As String, nombreAnexo As String, tamAnexo As String)
		On Error Goto handler
		Dim vAct As New Vector(0), vNom As New Vector(0), vTam As New Vector(0)
		
		If doc.HasItem(CAMPO_FCARATULA_ANEXOS_ACTUACION) Then
			vAct.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_ACTUACION)
			vNom.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_NOMBRES)
			vTam.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_TAMAÑO)
		End If
		
		If Not vAct.isMember(nroAct,0,True) And Not vNom.isMember(nombreAnexo,0,True) _
		And Not vTam.isMember(tamAnexo,0,True) Then
			Call vAct.insertElement(nroAct,vAct.cantElem+1)
			Call vNom.insertElement(nombreAnexo,vNom.cantElem+1)
			Call vtam.insertElement(tamAnexo,vTam.cantElem+1)
			doc.ReplaceItemValue CAMPO_FCARATULA_ANEXOS_ACTUACION, vAct.values
			doc.ReplaceItemValue CAMPO_FCARATULA_ANEXOS_NOMBRES, vNom.values
			doc.ReplaceItemValue CAMPO_FCARATULA_ANEXOS_TAMAÑO, vTam.values
		End If
		Exit Sub
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método addAnexo","")
		Exit Sub
	End Sub
	'******************************************************************************************************************				
	
	Public Sub popAnexo ( nroAct As String, nombreAnexo As String, tamAnexo As String)
		On Error Goto handler
		Dim vAct As New Vector(0), vNom As New Vector(0), vTam As New Vector(0)
		Dim i As Integer
		
		If doc.HasItem(CAMPO_FCARATULA_ANEXOS_ACTUACION) Then
			vAct.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_ACTUACION)
			vNom.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_NOMBRES)
			vTam.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_TAMAÑO)
			For i = 1 To vAct.cantelem 
				If vAct.getElement(i) = nroAct And vNom.getElement(i)=nombreAnexo _
				And vTam.getElement(i) = tamAnexo Then
					vAct.deleteElement(i)
					vNom.deleteElement(i)
					vTam.deleteElement(i)
					doc.ReplaceItemValue CAMPO_FCARATULA_ANEXOS_ACTUACION, vAct.values
					doc.ReplaceItemValue CAMPO_FCARATULA_ANEXOS_NOMBRES, vNom.values
					doc.ReplaceItemValue CAMPO_FCARATULA_ANEXOS_TAMAÑO, vTam.values
					Exit Sub
				End If
			Next						
		End If
		Error ERROR_ANEXO_NOT_FOUND, MSG_ERROR_ANEXO_NOT_FOUND & nombreAnexo
		
		Exit Sub
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método popAnexo","")
		Exit Sub
	End Sub
	'******************************************************************************************************************					
	Public Function getAnexosAct (nroAct As String, campo As String) As Vector
		On Error Goto handler
		Dim vAct As New Vector(0), vNom As New Vector(0), vTam As New Vector(0)
		Dim vAux As New Vector(0), i As Integer
		
		vAct.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_ACTUACION)
		vNom.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_NOMBRES)
		vTam.values = doc.GetItemValue(CAMPO_FCARATULA_ANEXOS_TAMAÑO)
		For i = 1 To vAct.cantelem 
			If vAct.getElement(i) = nroAct Then
				If campo = CAMPO_FCARATULA_ANEXOS_NOMBRES Then
					Call vAux.insertElement(vNom.getElement(i), vAux.cantElem+1)
				Else
					Call vAux.insertElement(vTam.getElement(i),vAux.cantElem+1)
				End If
			End If
		Next
		Set getAnexosAct = vAux
		Exit Function
handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método getAnexosAct","")
		Exit Function
	End Function
	'******************************************************************************************************************						
	Function esMigrado As Boolean
		On Error Goto handler
		If doc.HasItem(CAMPO_FCARATULA_MIGRADO) Then 
			If (Cint(doc.GetItemValue(CAMPO_FCARATULA_MIGRADO)(0))=1) Then 
				esMigrado=True
			Else
				esMigrado=False
			End If
		Else
			esMigrado=False
		End If
		Exit Function
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método esMigrado","")
		Exit Function	
	End Function
	'******************************************************************************************************************		
	Public Sub registrarAsuntoGenerado(nroActuacion As String)
		On Error Goto Handler
		
		Dim pos As Long
		Dim vActsGeneraronAsuntos As New Vector(0)
		vActsGeneraronAsuntos.Values = doc.Getitemvalue(CAMPO_FCARATULA_ACTS_GEN_ASUNTOS)
		If Not vActsGeneraronAsuntos.isMember(nroActuacion, pos, false) Then
			Call vActsGeneraronAsuntos.insertElement(nroActuacion, vActsGeneraronAsuntos.cantElem + 1)
			Call doc.Replaceitemvalue(CAMPO_FCARATULA_ACTS_GEN_ASUNTOS, vActsGeneraronAsuntos.Values)
		End If
		Exit Sub
Handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método registrarAsuntoGenerado","")
		Exit Sub
	End Sub
	'******************************************************************************************************************		
	Public Sub registrarAsuntoEnSesion(nroSesion As String, nroPunto As String, estado As String)
		On Error Goto Handler
		
		Dim pos As Long
		Dim vPuntosNroSesion As New Vector(0)
		vPuntosNroSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_SESION_PTOS)
		Dim vPuntosNroPtoEnSesion As New Vector(0)
		vPuntosNroPtoEnSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_PTOS_EN_SESION)
		Dim vPuntosEstadoPtoEnSesion As New Vector(0)
		vPuntosEstadoPtoEnSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_ESTADO_PTOS_EN_SESION)
		
		Call vPuntosNroSesion.insertElement(nroSesion, vPuntosNroSesion.cantElem + 1)
		Call vPuntosNroPtoEnSesion.insertElement(nroPunto, vPuntosNroPtoEnSesion.cantElem + 1)
		Call vPuntosEstadoPtoEnSesion.insertElement(estado, vPuntosEstadoPtoEnSesion.cantElem + 1)
		
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_NRO_SESION_PTOS, vPuntosNroSesion.values)
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_NRO_PTOS_EN_SESION, vPuntosNroPtoEnSesion.values)
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_ESTADO_PTOS_EN_SESION, vPuntosEstadoPtoEnSesion.values)
		
		Exit Sub
Handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método registrarAsuntoGenerado","")
		Exit Sub
	End Sub
	'******************************************************************************************************************		
	Public Sub RegistrarResolucion(nroSesion As String, nroPunto As String, nroResol As String, docSol As NotesDocument)
		On Error Goto Handler
		
		Dim pos As Long
		Dim vResolNroSesion As New Vector(0)
		vResolNroSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_SESION_RESOL)
		Dim vResolNro As New Vector(0)
		vResolNro.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_RESOL)
		Dim vResolFecha As New Vector(0)
		vResolFecha.Values = doc.Getitemvalue(CAMPO_FCARATULA_FECHA_RESOL)
		Dim vResolPdf As New Vector(0)
		vResolPdf.Values = doc.Getitemvalue(CAMPO_FCARATULA_PDF_RESOL)
		
		Dim dia As String
		Dim mes As String
		Dim anio As String
		
		dia = right("00" & Day(Today),2)
		mes = Right("00" & Month(Today),2)
		anio = Right("0000" & Year(Today),4)
		
		If docSol.Hasitem("ArchivoPdf") Then
			Call vResolPdf.insertElement(docSol.Getitemvalue("NombreArchivoPdf")(0)&".pdf",vResolPdf.cantElem + 1)
			Call doc.Copyitem(docSol.Getfirstitem("ArchivoPdf"), "pdfResol_"+CStr(vResolPdf.cantElem + 1))
		Else
			Call vResolPdf.insertElement("NO", vResolPdf.cantElem + 1)
		End If
		
		Call vResolNroSesion.insertElement(nroSesion, vResolNroSesion.cantElem + 1)
		Call vResolNro.insertElement(nroResol, vResolNro.cantElem + 1)
		Call vResolFecha.insertElement(dia+"/"+mes+"/"+anio, vResolFecha.cantElem + 1)
		
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_NRO_SESION_RESOL, vResolNroSesion.values)
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_NRO_RESOL, vResolNro.values)
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_FECHA_RESOL, vResolFecha.values)
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_PDF_RESOL, vResolPdf.values)
		
		Exit Sub
Handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método RegistrarResolucion","")
		Exit Sub
	End Sub
	'******************************************************************************************************************		
	Public Sub quitarAsunto(nroSesion As String, nroPunto As String)
		On Error Goto Handler
		
		Dim pos As Long
		Dim vPuntosNroSesion As New Vector(0)
		vPuntosNroSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_SESION_PTOS)
		Dim vPuntosNroPtoEnSesion As New Vector(0)
		vPuntosNroPtoEnSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_PTOS_EN_SESION)
		Dim vPuntosEstadoPtoEnSesion As New Vector(0)
		vPuntosEstadoPtoEnSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_ESTADO_PTOS_EN_SESION)
		
		Dim encontre As Boolean
		Dim indice As Integer
		indice = 1
		encontre = false
		While Not encontre And indice <= vPuntosNroPtoEnSesion.cantElem
			encontre = (vPuntosNroPtoEnSesion.getElement(indice) = nroPunto) And (vPuntosNroSesion.getElement(indice) = nroSesion)
			If Not encontre then
				indice = indice + 1
			End if
		Wend
		
		If encontre Then
			vPuntosNroSesion.deleteElement(indice)
			vPuntosNroPtoEnSesion.deleteElement(indice)
			vPuntosEstadoPtoEnSesion.deleteElement(indice)	
		End if
		
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_NRO_SESION_PTOS, vPuntosNroSesion.values)
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_NRO_PTOS_EN_SESION, vPuntosNroPtoEnSesion.values)
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_ESTADO_PTOS_EN_SESION, vPuntosEstadoPtoEnSesion.values)
		
		Exit Sub
Handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método quitarAsunto","")
		Exit Sub
	End Sub
	'******************************************************************************************************************		
	Public Sub ActualizarAsunto(nroSesion As String, nroPunto As String, estado As String)
		On Error Goto Handler
		
		Dim pos As Long
		Dim vPuntosNroSesion As New Vector(0)
		vPuntosNroSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_SESION_PTOS)
		Dim vPuntosNroPtoEnSesion As New Vector(0)
		vPuntosNroPtoEnSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_NRO_PTOS_EN_SESION)
		Dim vPuntosEstadoPtoEnSesion As New Vector(0)
		vPuntosEstadoPtoEnSesion.Values = doc.Getitemvalue(CAMPO_FCARATULA_ESTADO_PTOS_EN_SESION)
		
		Dim encontre As Boolean
		Dim indice As Integer
		indice = 1
		encontre = false
		While Not encontre And indice <= vPuntosNroPtoEnSesion.cantElem
			encontre = (vPuntosNroPtoEnSesion.getElement(indice) = nroPunto) And (vPuntosNroSesion.getElement(indice) = nroSesion)
			If Not encontre then
				indice = indice + 1
			End if
		Wend
		
		If encontre Then
			Call vPuntosEstadoPtoEnSesion.replaceElement(indice, estado)	
		End if
		
		Call doc.Replaceitemvalue(CAMPO_FCARATULA_ESTADO_PTOS_EN_SESION, vPuntosEstadoPtoEnSesion.values)
		
		Exit Sub
Handler:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método ActualizarAsunto","")
		Exit Sub
	End Sub
	'******************************************************************************************************************	
	Public Function getColumnaRecorridoMigrado(Byval nColumna As Integer) As Vector
		'Devuelve los valores de la columna indicada para la tabla de recorrido
		On Error Goto HANDLER
		
		Set getColumnaRecorridoMigrado= New Vector(0)
		Select Case(nColumna)
			Case 1:
				If (doc.HasItem(CAMPO_FCARATULA_FERMIGRADO)) Then
					getColumnaRecorridoMigrado.values=doc.getItemValue(CAMPO_FCARATULA_FERMIGRADO)
				Else
					Set getColumnaRecorridoMigrado=New Vector(0)
				End If
			Case 2:
				If (doc.HasItem(CAMPO_FCARATULA_FSRMIGRADO)) Then
					getColumnaRecorridoMigrado.values=doc.getItemValue(CAMPO_FCARATULA_FSRMIGRADO)
				Else
					Set getColumnaRecorridoMigrado=New Vector(0)
				End If
			Case 3:
				If (doc.HasItem(CAMPO_FCARATULA_URMIGRADO)) Then
					getColumnaRecorridoMigrado.values=doc.getItemValue(CAMPO_FCARATULA_URMIGRADO)
				Else
					Set getColumnaRecorridoMigrado=New Vector(0)
				End If
				
			Case 4:
				If (doc.HasItem(CAMPO_FCARATULA_DRMIGRADO)) Then
					getColumnaRecorridoMigrado.values=doc.getItemValue(CAMPO_FCARATULA_DRMIGRADO)
				Else
					Set getColumnaRecorridoMigrado=New Vector(0)
				End If
			Case 5:
				If (doc.HasItem(CAMPO_FCARATULA_NROBOLMIGRADO)) Then
					getColumnaRecorridoMigrado.values=doc.getItemValue(CAMPO_FCARATULA_NROBOLMIGRADO)
				Else
					Set getColumnaRecorridoMigrado=New Vector(0)
				End If
			Case Else
				
		End Select
		
		Exit Function
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método getColumnaRecorridoMigrado","")
		Exit Function
	End Function
	'******************************************************************************************************************	
	Public Sub copiarCamposCaratulaADocumento(unid As String, dbWS As NotesDatabase)
		On Error GoTo HANDLER
		Dim confExp As New Configuracion
		Dim camposExp As Vector
		Dim camposInf As Vector
		Dim docAttach As NotesDocument
		Dim VectorCampos As New Vector(0)
		Dim valorCampo As New Vector(0)
		Dim opciones As New Vector(0)
		
		Set docAttach = dbWS.Getdocumentbyunid(unid)
		
		Set camposExp = confExp.ClavesCamposInterExpInf
		Set camposInf = confExp.ClavesCamposInterInfInf
		
		VectorCampos.Values = Split(doc.Getitemvalue(CAMPO_FCARATULA_VECTOR_CAMPOS)(0),"#%")
		
		Dim i As Integer
		Dim j As Integer
		Dim k As Integer
		Dim l As Integer
		Dim campoExp As String
		Dim campoInf As String
		Dim campoNotes As String
		Dim valorCampoNotes As String
		Dim salir As Boolean
		Dim Valor As String
		Dim vValor As New Vector(0)
		Dim valores As New Vector(0)
		Dim valoresMulti As New Vector(0)
		For i = 1 To camposExp.cantElem
			campoExp =  camposExp.getElement(i)
			campoInf =  camposInf.getElement(i)
			If doc.Hasitem(campoExp) Then
				Call docAttach.Replaceitemvalue(campoInf,doc.Getitemvalue(campoExp))
			Else
				For j = 1 To VectorCampos.cantElem
					campoNotes = VectorCampos.getElement(j)
					valorCampoNotes = doc.Getitemvalue(campoNotes)(0)
					valorCampo.Values = Split(valorCampoNotes,"#%")
					If(valorCampo.cantElem >= 4) Then
						If valorCampo.getElement(2) = campoExp Then
							If(valorCampo.getElement(4) = "*undefined*") Then
								Call docAttach.Replaceitemvalue(campoInf,"")
							Else
								If(InStr( campoNotes, "Combobox") = 1 Or InStr( campoNotes, "Radio") = 1 Or InStr( campoNotes, "Checkbox") = 1 Or InStr( campoNotes, "PickList") = 1)Then
									If (valorCampo.getElement(7) =  "Valores") Then
										opciones.values = Split(valorCampo.getElement(6),",")
									Else
										Dim dbDatosExt As NotesDatabase 
										Dim vDatosExt As NotesView 
										Dim colDatosExt As NotesDocumentCollection
										Dim docDatos As NotesDocument
										Set dbDatosExt = confExp.ReferenciarBaseDeDatos(CLAVE_DBDATOS_EXTERNOS)
										Set vDatosExt = dbDatosExt.Getview("DatosExternos")
										Set colDatosext = vDatosExt.Getalldocumentsbykey(valorCampo.getElement(6), true)
										Set opciones = New Vector(0)
										Set docDatos = colDatosext.Getfirstdocument()
										While Not docDatos Is Nothing
											Call opciones.insertElement(docDatos.Getitemvalue("Valor")(0)+"|"+docDatos.Getitemvalue("Clave")(0), opciones.cantElem+1)
											Set docDatos = coldatosext.Getnextdocument(docDatos) 
										Wend
									End if
								End if
								If( InStr( campoNotes, "Combobox") = 1 Or InStr( campoNotes, "Radio") = 1) Then
									'opciones.values = Split(valorCampo.getElement(6),",")
									salir = False
									k = 1
									valor = ""
									While Not salir and k <= opciones.cantElem
										vvalor.values = Split(opciones.getElement(k),"|")
										If(vvalor.getElement(2) = valorCampo.getElement(4)) Then
											valor = vvalor.getElement(1)
											salir = True
										End If
										k = k+1
									Wend
									Call docAttach.Replaceitemvalue(campoInf,valor)
								ElseIf  InStr( campoNotes, "Checkbox") = 1 Then
									'opciones.values = Split(valorCampo.getElement(6),",")
									valoresMulti.Values = Split(valorCampo.getElement(4),",")
									k = 1
									Set valores = New Vector(0)
									While k <= valoresMulti.cantElem
										vvalor.values = Split(opciones.getElement(k),"|")
										If(valoresMulti.getElement(k) = "true") Then
											Call valores.insertElement(vvalor.getElement(1), valores.cantElem+1)
										End If
										k = k+1
									Wend
									Call docAttach.Replaceitemvalue(campoInf,valores.Values)
								ElseIf  InStr( campoNotes, "PickList") = 1 Then
									'opciones.values = Split(valorCampo.getElement(6),",")
									valoresMulti.Values = Split(valorCampo.getElement(4),",")
									Set valores = New Vector(0)
									For l=1 To valoresMulti.cantElem
										salir = False
										k = 1
										While Not salir and k <= opciones.cantElem
											vvalor.values = Split(opciones.getElement(k),"|")
											If(vvalor.getElement(2) = valoresMulti.getElement(l)) Then
												Call valores.insertElement(vvalor.getElement(1), valores.cantElem+1)
												salir = True
											End If
											k = k+1
										Wend
									Next
									Call docAttach.Replaceitemvalue(campoInf,valores.Values)
								Else
									Call docAttach.Replaceitemvalue(campoInf,valorCampo.getElement(4))
								End If
							End If
						End If
					End If
				Next
			End If
		Next
		docAttach.save True, False
		Exit Sub
HANDLER:
		Call RegistrarYGenerarError(NOMBRE_APLICACION,"Clase Caratula - Método copiarCamposCaratulaADocumento","")
		Exit Sub
	End Sub
	'******************************************************************************************************************	
	
End Class 