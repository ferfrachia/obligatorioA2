var dayA = new Array();var monthA = new Array();var yearA = new Array();var targetfield;monthA[0]="Enero";monthA[1]="Febrero";monthA[2]="Marzo";monthA[3]="Abril";monthA[4]="Mayo";monthA[5]="Junio";monthA[6]="Julio";monthA[7]="Agosto"; monthA[8]="Septiembre"; monthA[9]="Octubre";monthA[10]="Noviembre"; monthA[11]="Diciembre";for(var i=1;i<=31;i++) { dayA[i]=i; } for(var i=0;i<10;i++) { yearA[i]=gy(i); } function gm(num) { var mydate = new Date(); mydate.setDate(1); mydate.setMonth(num-1); var datestr = "" + mydate; return datestr.substring(4,7); } function gy(num) { var mydate = new Date(); return (eval(mydate.getYear()) - 4 + num); } function ud(mon) { var i = mon.selectedIndex; if(mon.options[i].value == "2") { document.forms[0].day.options[30] = null; document.forms[0].day.options[29] = null; var j = document.forms[0].year.selectedIndex; var year = eval(document.forms[0].year.options[j].value); if ( ((year%400)==0) || (((year%100)!=0) && ((year%4)==0)) ) { if (document.forms[0].day.options[28] == null) { document.forms[0].day.options[28] = new Option("29"); document.forms[0].day.options[28].value = "29"; } } else { document.forms[0].day.options[28] = null; } } if(mon.options[i].value == "1" || mon.options[i].value == "3" || mon.options[i].value == "5" || mon.options[i].value == "7" || mon.options[i].value == "8" || mon.options[i].value == "10" || mon.options[i].value == "12") { if (document.forms[0].day.options[28] == null) { document.forms[0].day.options[28] = new Option("29"); document.forms[0].day.options[28].value = "29"; } if (document.forms[0].day.options[29] == null) { document.forms[0].day.options[29] = new Option("30"); document.forms[0].day.options[29].value = "30"; } if (document.forms[0].day.options[30] == null) { document.forms[0].day.options[30] = new Option("31"); document.forms[0].day.options[30].value = "31"; } } if(mon.options[i].value == "4" || mon.options[i].value == "6" || mon.options[i].value == "9" || mon.options[i].value == "11") { if (document.forms[0].day.options[28] == null) { document.forms[0].day.options[28] = new Option("29"); document.forms[0].day.options[28].value = "29"; } if (document.forms[0].day.options[29] == null) { document.forms[0].day.options[29] = new Option("30"); document.forms[0].day.options[29].value = "30"; } document.forms[0].day.options[30] = null; } if (document.forms[0].day.selectedIndex == -1) document.forms[0].day.selectedIndex = 0; } function showdate() { var i = document.forms[0].month.selectedIndex; var j = document.forms[0].day.selectedIndex; var k = document.forms[0].year.selectedIndex; alert(document.forms[0].day.options[j].value + "/" + document.forms[0].month.options[i].value + "/" + document.forms[0].year.options[k].value) } function opencalendar(temptargetfield) {var field= eval("document.forms[1]." + temptargetfield);targetfield = "opener.document.forms[1]." + temptargetfield + ".value";var mydate;if(field.value == "" || field.value.length < 10 || field.value.length >10){mydate = new Date(); }else{var tempday = field.value.charAt(0).toString() + field.value.charAt(1).toString();var tempmonth = (parseInt((parsemonth(field.value.charAt(3).toString(), field.value.charAt(4).toString())))-1).toString();var tempyear = (parseInt(field.value.charAt(6).toString() + field.value.charAt(7).toString() + field.value.charAt(8).toString() + field.value.charAt(9).toString())).toString();mydate = new Date(tempyear, tempmonth, tempday ); }for(var i=0;i<=monthA.length;i++) { if (mydate.getMonth() == i) {month = i+1;}} year = mydate.getYear();//yearA[4].toString();//calwin = window.open('','calwin','alwaysRaised=yes,scrollbars=yes,status=yes,toolbar=yes,resizable=yes,directories=yes,height=150, width=175'); calwin = window.open('','calwin','alwaysRaised=yes,height=160, width=175'); calwin.resizeTo(185, 195);calccal(calwin,month,year,targetfield); } function parsemonth(tmpm1, tmpm2){var m1;var m2;var m3;if (tmpm1 == "0"){m1 = "";}else{m1 = "1";}m2 = tmpm2;m3 = m1.toString() + m2.toString();return m3;}function calccal(targetwin,month,year,targetfield) { var monthname = new Array(12); monthname[0] = "Enero"; monthname[1] = "Febrero"; monthname[2] = "Marzo"; monthname[3] = "Abril"; monthname[4] = "Mayo"; monthname[5] = "Junio"; monthname[6] = "Julio"; monthname[7] = "Agosto"; monthname[8] = "Septiembre"; monthname[9] = "Octubre"; monthname[10] = "Noviembre"; monthname[11] = "Diciembre"; var endday = calclastday(eval(month),eval(year)); mystr = month + "/01/" + year; mydate = new Date(mystr); firstday = mydate.getDay(); var cnt = 0; var day = new Array(6); for (var i=0; i<6; i++) day[i] = new Array(7); for (var r=0; r<6; r++) { for (var c=0; c<7; c++) { if ((cnt==0) && (c!=firstday)) continue; cnt++; day[r][c] = cnt; if (cnt==endday) break; } if (cnt==endday) break; } targetwin.document.write("<HTML>");targetwin.document.write("<HEAD>");targetwin.document.write("<TITLE>Calendario</TITLE>");targetwin.document.write("<link rel=\"stylesheet\" href= \"/stylesCal.css\">");targetwin.document.write("</HEAD>");targetwin.document.write("<BODY BGCOLOR=\"#FFFFFF\" TEXT=\"#000000\" LINK=\"#003399\" VLINK=\"#003399\" ALINK=\"#003399\" TOPMARGIN=\"5\" LEFTMARGIN=\"0\" MARGINWIDTH=\"0\" MARGINHEIGHT=\"5\" BACKGROUND=\"/background.gif\">");targetwin.document.write("<FORM>");targetwin.document.write("<TABLE BORDER=\"0\" CELLPADDING=\"0\" CELLSPACING=\"0\" WIDTH=\"175\"><TR>"); targetwin.document.write("<TD WIDTH=\"5\" ROWSPAN=\"6\"><IMG SRC=\" /space.gif\" WIDTH=\"5\" HEIGHT=\"5\"></TD>");var prevyear = eval(year) - 1; //targetwin.document.write("<TD><INPUT TYPE=BUTTON NAME=prevyearbutton VALUE='<<'"+ // " onclick='document.close();opener.calccal(opener.calwin,"+month+","+prevyear+",\""+targetfield+"\")'></TD>"); var prevmonth = calcprevmonth(month); var prevmonthyear = calcprevyear(month,year); targetwin.document.write("<TD HEIGHT=\"19\" BGCOLOR=\"#336699\" NOWRAP ALIGN=\"center\" COLSPAN=\"3\">");targetwin.document.write("<A NAME=prevmonthbutton HREF=\"javascript:document.close(); javascript:opener.calccal(opener.calwin,"+prevmonth+","+prevmonthyear+",'"+targetfield+"');\">");targetwin.document.write("<IMG SRC=\"arrow_left.gif?OpenImageResource\" WIDTH=\"11\" HEIGHT=\"8\" BORDER=\"0\"></A>"); var index = eval(month) - 1; targetwin.document.write("&nbsp;&nbsp;<B><FONT CLASS=\"sw\">" + monthname[index] + " " + year + "</FONT></B>&nbsp;&nbsp;"); var nextmonth = calcnextmonth(month); var nextmonthyear = calcnextyear(month,year); //targetwin.document.write("<A HREF=\"#\" NAME=nextmonthbutton onclick='document.close();opener.calccal(opener.calwin,"+nextmonth+","+nextmonthyear+",\""+targetfield+"\")'>"); //targetwin.document.write("<IMG SRC=\"/arrow_right.gif\" WIDTH=\"11\" HEIGHT=\"8\" BORDER=\"0\"></A></TD>"); targetwin.document.write("<A NAME=nextmonthbutton HREF=\"javascript:document.close(); javascript:opener.calccal(opener.calwin,"+nextmonth+","+nextmonthyear+",'"+targetfield+"');\">"); targetwin.document.write("<IMG SRC=\"arrow_right.gif?OpenImageResource\" WIDTH=\"11\" HEIGHT=\"8\" BORDER=\"0\"></A></TD>"); var nextyear = eval(year) + 1; //targetwin.document.write("<TD><INPUT TYPE=BUTTON NAME=nextyearbutton VALUE='>>'"+ //" onclick='document.close();opener.calccal(opener.calwin,"+month+","+nextyear+",\""+targetfield+"\")'></TD>"); targetwin.document.write("<TD WIDTH=\"5\" ROWSPAN=\"6\"><IMG SRC=\" /space.gif\" WIDTH=\"5\" HEIGHT=\"5\"></TD>");targetwin.document.write("</TR>");targetwin.document.write("<TR>"); targetwin.document.write("<TD WIDTH=\"1\" BGCOLOR=\"#336699\" ROWSPAN=\"4\"><IMG SRC=\"/space.gif\" WIDTH=\"1\" HEIGHT=\"1\"></TD>");targetwin.document.write("<TD WIDTH=\"1\" BGCOLOR=\"#999999\" ><IMG SRC=\"/space.gif\" WIDTH=\"1\" HEIGHT=\"1\"></TD>");targetwin.document.write("<TD WIDTH=\"1\" BGCOLOR=\"#336699\" ROWSPAN=\"4\"><IMG SRC= \"/space.gif\" WIDTH=\"1\" HEIGHT=\"1\"></TD>"); targetwin.document.write("</TR>"); targetwin.document.write("<TR BGCOLOR=\"#ffffff\">");targetwin.document.write("<TD ALIGN=\"center\" WIDTH=\"173\">");targetwin.document.write("<BASEFONT FACE=\"arial,sans-serif,helvetica\" COLOR=\"#000000\" CLASS=\"f\">");targetwin.document.write("<TABLE BORDER=\"0\" CELLPADDING=\"2\" CELLSPACING=\"0\" WIDTH=\"140\"><TR VALIGN=TOP><FORM>"); targetwin.document.write("<TR>"); targetwin.document.write("<TD COLSPAN=\"7\"><IMG SRC=\" /space.gif\" WIDTH=\"1\" HEIGHT=\"1\"></TD>");targetwin.document.write("</TR>"); targetwin.document.write("<TR ALIGN=\"right\" CLASS=\"f\">"); targetwin.document.write("<TD WIDTH=\"20\">Do</TD>"); targetwin.document.write("<TD WIDTH=\"20\">Lu</TD>"); targetwin.document.write("<TD WIDTH=\"20\">Ma</TD>"); targetwin.document.write("<TD WIDTH=\"20\">Mi</TD>"); targetwin.document.write("<TD WIDTH=\"20\">Ju</TD>"); targetwin.document.write("<TD WIDTH=\"20\">Vi</TD>"); targetwin.document.write("<TD WIDTH=\"20\">Sa</TD>"); targetwin.document.write("</TR>"); targetwin.document.write("<TR>"); targetwin.document.write("<TD COLSPAN=\"7\"><IMG SRC=\" /space.gif\" WIDTH=\"1\" HEIGHT=\"1\"></TD>");targetwin.document.write("</TR>"); // targetwin.document.write("<TR><TD COLSPAN=7><HR NOSHADE></TD></TR>"); var selectedmonth = eval(month) - 1; var strselectedmonth;if (selectedmonth<9)	strselectedmonth="0" +(selectedmonth+1).toString();else	strselectedmonth=(selectedmonth+1).toString();	var today = new Date(); var thisyear = today.getYear(); var selectedyear = eval(year) - thisyear + 4; var strDay;var conditionalpadder = ""; for(r=0; r<6; r++)  { targetwin.document.write("<TR ALIGN=\"right\" CLASS=\"f\">"); for(c=0; c<7; c++) { targetwin.document.write("<TD>"); if(day[r][c] != null) { if (day[r][c] < 10) {strDay = "0" + (day[r][c]).toString();conditionalpadder = "&nbsp;" }else {strDay = (day[r][c]).toString();conditionalpadder = ""; }targetwin.document.write("<A HREF=\"#\" NAME="+day[r][c]+ " VALUE=" + conditionalpadder + day[r][c] + conditionalpadder + " onClick=\"window.close();" +targetfield+"='"+strDay+ "/"+strselectedmonth + "/" + yearA[selectedyear.toString()]+"';\";>"+ conditionalpadder + day[r][c] + conditionalpadder +"</A>"); } targetwin.document.write("</TD>"); } targetwin.document.write("</TR>"); } targetwin.document.write("</TABLE></BR>"); targetwin.document.write("</BASEFONT>"); targetwin.document.write("</TD>");targetwin.document.write("</TR>");targetwin.document.write("<TR BGCOLOR=\"#336699\">");targetwin.document.write("<TD HEIGHT=\"1\" ><IMG SRC=\" /space.gif\" WIDTH=\"1\" HEIGHT=\"1\"></TD>");targetwin.document.write("</TR>");targetwin.document.write("</TABLE>"); targetwin.document.write("</FORM>");targetwin.document.write("</BODY>");targetwin.document.write("</HTML>");} function calclastday(month,year) { if ((month==2) && ((year%4)==0)) return 29; if ((month==2) && ((year%4)!=0)) return 28; if ((month==1) || (month == 3) || (month == 5) || (month == 7) || (month==8) || (month == 10) || (month ==12)) return 31; return 30; } function calcnextmonth(month) { if (month=="12") return "1"; else return (eval(month)+1); } function calcnextyear(month,year) { if (month=="12") return (eval(year)+1); else return (year); } function calcprevmonth(month) { if (month=="1") return "12"; else return (eval(month)-1); } function calcprevyear(month,year) { if (month=="1") return (eval(year)-1); else return (year); } 